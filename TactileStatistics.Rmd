---
title: "Tactile navigation"
author: "Jeppe"
date: '2023-05-01'
output: html_document
editor_options: 
  markdown: 
    wrap: 72
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE) 

knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)

#Imports data outside working directory
library(readxl)
filename = "~/Downloads/A - SART&SUS&DEMOGRAPHICS.xlsx" #path for macbook downloads folder
SartSusDemo <- read_excel(filename, sheet= "DataanalyseExport")

#Farven på alle plots er defineret ud fra palette
    Palette<-"Set1"

```

```{r,echo=FALSE} 
## Gives count, mean, standard deviation, standard error of the mean, and confidence interval (default 95%).
##   data: a data frame.
##   measurevar: the name of a column that contains the variable to be summariezed
##   groupvars: a vector containing names of columns that contain grouping variables
##   na.rm: a boolean that indicates whether to ignore NA's
##   conf.interval: the percent range of the confidence interval (default is 95%)
summarySE <- function(data=NULL, measurevar, groupvars=NULL, na.rm=FALSE,
                      conf.interval=.95, .drop=TRUE) {
    library(plyr)

    # New version of length which can handle NA's: if na.rm==T, don't count them
    length2 <- function (x, na.rm=FALSE) {
        if (na.rm) sum(!is.na(x))
        else       length(x)
    }

    # This does the summary. For each group's data frame, return a vector with
    # N, mean, and sd
    datac <- ddply(data, groupvars, .drop=.drop,
      .fun = function(xx, col) {
        c(N    = length2(xx[[col]], na.rm=na.rm),
          mean = mean   (xx[[col]], na.rm=na.rm),
          sd   = sd     (xx[[col]], na.rm=na.rm)
        )
      },
      measurevar
    )

    # Rename the "mean" column    
    datac <- rename(datac, c("mean" = measurevar))

    datac$se <- datac$sd / sqrt(datac$N)  # Calculate standard error of the mean

    # Confidence interval multiplier for standard error
    # Calculate t-statistic for confidence interval: 
    # e.g., if conf.interval is .95, use .975 (above/below), and use df=N-1
    ciMult <- qt(conf.interval/2 + .5, datac$N-1)
    datac$ci <- datac$se * ciMult

    return(datac)
}
pd <- position_dodge(0.1) # move them .05 to the left and right

```
```{r}
library(cowplot)
dev.new(width=5,height=4,noRStudioGD = TRUE)

SaveSixPlots <- function(Metric="NULL",filetype=".pdf"){
     Palette<-"Set1"

     plot1 <- plot1 +scale_colour_brewer(palette=Palette)
     plot2 <- plot2 +scale_colour_brewer(palette=Palette)
     plot3 <- plot3 + scale_colour_brewer(palette=Palette)
     plot4 <- plot4 #+ scale_colour_brewer(palette=Palette)
     plot5 <- plot5 + scale_colour_brewer(palette=Palette)
     plot6 <- plot6 + scale_colour_brewer(palette=Palette)
     
    dir.create(Metric)
    title1 <-paste(Metric, "-1-Condition",filetype, sep = "", collapse=NULL)
    title2 <-paste(Metric, "-2-Gender",filetype, sep = "", collapse=NULL)
    title3 <-paste(Metric, "-3-ComputerGames",filetype, sep = "", collapse=NULL)
    title4 <-paste(Metric, "-4-YearsDriversLicence",filetype, sep = "", collapse=NULL)
    title5 <-paste(Metric, "-5-SimulatorExperience",filetype, sep = "", collapse=NULL)
    title6 <-paste(Metric, "-6-Automatic",filetype, sep = "", collapse=NULL)
  
    ggsave(filename=title1,plot=plot1, path = Metric)
    ggsave(filename=title2,plot=plot2, path = Metric)
    ggsave(filename=title3,plot=plot3, path = Metric)
    ggsave(filename=title4,plot=plot4, path = Metric)
    ggsave(filename=title5,plot=plot5, path = Metric)
    ggsave(filename=title6,plot=plot6, path = Metric)
    
    
    plot1
    plot2
    plot3
    plot4
    summary(model)
    plot5
    plot6
    out <- list(plot1, plot2,plot3, plot4,summary(model),plot5, plot6)  
    return(out)
}
```

## Introduction
A study on driving performance and In Vehicle infotainment system has been done. The study aims two answer two questions.
1) Can the addition of tactile navigation improve driving performance
2) Which tactile navigation (if any) improves driving performance most

The first part of this statistical analysis aims to investigate the sample to answer if the data is normally distributed and if the participants's characteristics are distributed across the four conditions. If this is not the case an effect of condition could be attributed to other personal factors of the participants (e.g. gaming experience).

Independent variable: Condition (Acrylic, Bar, Combination & Touch only)

Metrics: SUS, SART, Glance Time, Total Glances, Lane Breaks, Total Crash.

Demographics: Gender, Age, Gaming experience, Driving experience, Simulator experience, Car games experience, Automatic gear expereience

## Population
```{r, echo=FALSE} 
#                         !!!LÆS DETTE FOR AT FORSTÅ!!!
#Der bruges forskellige funktioner i disse plots. 
#Den første funktion ggplot vælger data og x og y akser. Eksempelevis x=condition og så fylder den farve på efter gender.
#Geom bar gør at plottet er et barplot med en stregtykkelse 
#Scale_y_continuous gør at man kan ændre y aksen med label og hakker
#scale_y_discrete gør man kan ændre y aksen med label og labels (for konditioner)
#scale_x_binned deler yeardriverslicence op i 16 grupper
#scale_fill_discrete gør man kan ændre labels på legend med titel og konditioner
#ggtitle ændrer titel
#Siden titlerne er ændret skal man lige fjerne dem og se om der er byttet rundt på konditioner. Man kan nemlig godt kalde bar for acrylic og så bliver vi forvirret
```

```{r, echo=FALSE} 
GenderCondition <- ggplot(data=SartSusDemo, mapping=aes(x=Condition,fill = Gender))
GenderCondition <- GenderCondition + geom_bar(col="black", size=.3)+ scale_y_continuous(name = "Count",breaks=c(0:15)) + ggtitle("Gender distribution")+ scale_fill_brewer(palette=Palette)

AgeCondition <- ggplot(data=SartSusDemo, mapping=aes(x=Age,fill = Condition))
AgeCondition <- AgeCondition + geom_bar(col="black", size=.3) + scale_y_continuous(name = "Count",breaks=c(0:15))+scale_x_continuous(breaks = c(20:34)) + scale_fill_discrete(name = "Condition") + ggtitle("Age distribution") + scale_fill_brewer(palette=Palette)

ComputerCondition <- ggplot(data=SartSusDemo, mapping=aes(x=Condition,fill = ComputerGames))
ComputerCondition <- ComputerCondition + geom_bar(col="black", size=.3) + scale_y_continuous(name = "Count",breaks=c(0:15)) +scale_fill_discrete(name = "Computer gaming (Hours)") + ggtitle("Gaming experience distribution") + scale_fill_brewer(palette=Palette)

DrivingCondition <- ggplot(data=SartSusDemo, mapping=aes(x=YearDriversLicence,fill = Condition))
DrivingCondition <- DrivingCondition + geom_bar(col="black", size=.3) + scale_y_continuous(name = "Count",breaks=c(0:15))+scale_x_binned(n.breaks = 20) + scale_fill_discrete(name = "Condition") + ggtitle("Drivers licence distribution")+ scale_fill_brewer(palette=Palette)

SimulatorYesNoExperienceCondition <- ggplot(data=SartSusDemo, mapping=aes(x=Condition,fill = SimulatorExperience))
SimulatorYesNoExperienceCondition <- SimulatorYesNoExperienceCondition + geom_bar(col="black", size=.3) + scale_y_continuous(name = "Count",breaks=c(0:15)) +scale_fill_discrete(name = "Car simulator experience") + ggtitle("Car simulator experience distribution")+ scale_fill_brewer(palette=Palette)

CarGamesCondition <- ggplot(data=SartSusDemo, mapping=aes(x=Condition,fill = CarGames))
CarGamesCondition <- CarGamesCondition + geom_bar(col="black", size=.3) + scale_y_continuous(name = "Count",breaks=c(0:15)) +scale_fill_discrete(name = "Car gaming (Hours)") + ggtitle("Car gaming experience distribution")+ scale_fill_brewer(palette=Palette)

CarSimulatorExperienceCondition <- ggplot(data=SartSusDemo, mapping=aes(x=Condition,fill = CarSimulators))
CarSimulatorExperienceCondition <- CarSimulatorExperienceCondition + geom_bar(col="black", size=.3) + scale_y_continuous(name = "Count",breaks=c(0:15)) +scale_fill_discrete(name = "Car simulator gaming (Hours)") + ggtitle("Car simulator gaming")+ scale_fill_brewer(palette=Palette)

AutomaticExperienceCondition <- ggplot(data=SartSusDemo, mapping=aes(x=Condition,fill = Automatic))
AutomaticExperienceCondition <-AutomaticExperienceCondition + geom_bar(col="black", size=.3) + scale_y_continuous(name = "Count",breaks=c(0:15)) + scale_fill_discrete(name = "Automatic experience  (Y/N)") + ggtitle("Automatic experience distribution")+ scale_fill_brewer(palette=Palette)




GenderCondition + scale_fill_brewer(palette=Palette)
AgeCondition+ scale_fill_brewer(palette=Palette)
ComputerCondition + scale_fill_brewer(palette=Palette)
DrivingCondition+ scale_fill_brewer(palette=Palette)
SimulatorYesNoExperienceCondition+ scale_fill_brewer(palette=Palette)
CarGamesCondition+ scale_fill_brewer(palette=Palette)
AutomaticExperienceCondition+ scale_fill_brewer(palette=Palette)
CarSimulatorExperienceCondition+ scale_fill_brewer(palette=Palette)
```

A summary of 'Age' and 'Years with drivers licence'. As with the bar graph for age we have a lot of people between 20-23 and most participants have had a drivers licence for 3-5 years.
```{r, echo=FALSE} 
Demographicssummary <- summary(SartSusDemo[c('Age','YearDriversLicence')])

Metricsummary <- summary(SartSusDemo[c('SART','SUS','Total_Glance_time','Total_Glances','Total_crash','Lane_Breaks')])
Demographicssummary

sd(SartSusDemo$Age)
sd(SartSusDemo$YearDriversLicence)

```

```{r,echo=FALSE}
dev.new(width=5,height=4,noRStudioGD = TRUE)

Metric="Demographics"
ggsave(filename="GenderCondition.pdf",plot=GenderCondition, path = Metric)
    ggsave(filename="AgeCondition.pdf",plot=AgeCondition, path = Metric)
    ggsave(filename="ComputerCondition.pdf",plot=ComputerCondition, path = Metric)
    ggsave(filename="DrivingCondition.pdf",plot=DrivingCondition, path = Metric)
    ggsave(filename="SimulatorYesNoExperienceCondition.pdf",plot=SimulatorYesNoExperienceCondition, path = Metric)
    ggsave(filename="CarGamesCondition.pdf",plot=CarGamesCondition, path = Metric)
    ggsave(filename="AutomaticExperienceCondition.pdf",plot=AutomaticExperienceCondition, path = Metric)
    ggsave(filename="CarSimulatorExperienceCondition.pdf",plot=CarSimulatorExperienceCondition, path = Metric)
```

## Effect due to condition
To answer the first question of whether condition have an effect on the 6 metrics we'll create a plot of means with confidence (95%) as whiskers. According to Geoff Cumming and Sue Finch if the data has the same standard deviation it is possible to gain insight into which data could be significantly different.

### Plot of means Condition/metric
```{r,echo=FALSE}
tgc <- summarySE(SartSusDemo, measurevar="SUS", groupvars=c("Condition"))
tgc
```
```{r,echo=FALSE}
# Use 95% confidence interval instead of SEM
SusCondition <- ggplot(tgc, aes(x=Condition, y=SUS, colour=Condition)) + 
    geom_errorbar(aes(ymin=SUS-ci, ymax=SUS+ci), width=.1, position=pd) +
    geom_line(position=pd) +
    geom_point(position=pd) 
SusCondition  + scale_colour_brewer(palette=Palette)
```
```{r,echo=FALSE}
tgc <- summarySE(SartSusDemo, measurevar="SART", groupvars=c("Condition"))
tgc
```
```{r,echo=FALSE}
# Use 95% confidence interval instead of SEM
SartCondition <- ggplot(tgc, aes(x=Condition, y=SART, colour=Condition)) + 
    geom_errorbar(aes(ymin=SART-ci, ymax=SART+ci), width=.1, position=pd) +
    geom_line(position=pd) +
    geom_point(position=pd)
SartCondition+scale_colour_brewer(palette=Palette)
```
```{r,echo=FALSE}
tgc <- summarySE(SartSusDemo, measurevar="Total_crash", groupvars=c("Condition"))
tgc
```
```{r,echo=FALSE}
# Use 95% confidence interval instead of SEM
CrashCondition <- ggplot(tgc, aes(x=Condition, y=Total_crash, colour=Condition)) + 
    geom_errorbar(aes(ymin=Total_crash-ci, ymax=Total_crash+ci), width=.1, position=pd) +
    geom_line(position=pd) +
    geom_point(position=pd)
CrashCondition+scale_colour_brewer(palette=Palette)
```
```{r,echo=FALSE}
tgc <- summarySE(SartSusDemo, measurevar="Lane_Breaks", groupvars=c("Condition"))
tgc
```
```{r,echo=FALSE}
# Use 95% confidence interval instead of SEM
LaneCondition <- ggplot(tgc, aes(x=Condition, y=Lane_Breaks, colour=Condition)) + 
    geom_errorbar(aes(ymin=Lane_Breaks-ci, ymax=Lane_Breaks+ci), width=.1, position=pd) +
    geom_line(position=pd) +
    geom_point(position=pd)
LaneCondition+scale_colour_brewer(palette=Palette)
```
```{r,echo=FALSE}
tgc <- summarySE(SartSusDemo, measurevar="Total_Glances", groupvars=c("Condition"))
tgc
```
```{r,echo=FALSE}
# Use 95% confidence interval instead of SEM
GlancesCondition <- ggplot(tgc, aes(x=Condition, y=Total_Glances, colour=Condition)) + 
    geom_errorbar(aes(ymin=Total_Glances-ci, ymax=Total_Glances+ci), width=.1, position=pd) +
    geom_line(position=pd) +
    geom_point(position=pd)
GlancesCondition+scale_colour_brewer(palette=Palette)
```
```{r,echo=FALSE}
tgc <- summarySE(SartSusDemo, measurevar="Total_Glance_time", groupvars=c("Condition"))
tgc
```
```{r,echo=FALSE}
# Use 95% confidence interval instead of SEM
GlanceTimeCondition<- ggplot(tgc, aes(x=Condition, y=Total_Glance_time, colour=Condition)) + 
    geom_errorbar(aes(ymin=Total_Glance_time-ci, ymax=Total_Glance_time+ci), width=.1, position=pd) +
    geom_line(position=pd) +
    geom_point(position=pd)
GlanceTimeCondition+scale_colour_brewer(palette=Palette)
```

To test significance we will use ANOVA
ANOVA has Three assumptions
1) Normality
2) Homogenity
3) Independence
The assumption of Independence is meet as our participants haven't influence each other in any way we know of. The participants were instructed not to speak with each other between trials and we can hope they have met this instruction.

### Test of normality - Condition/metric
```{r}
Cond1 <- subset(SartSusDemo, SartSusDemo$Condition=='Combination')
Cond2 <- subset(SartSusDemo, SartSusDemo$Condition=='Touch_only')
Cond3 <- subset(SartSusDemo, SartSusDemo$Condition=='Bar')
Cond4 <- subset(SartSusDemo, SartSusDemo$Condition=='Acrylic')

  shapiro.test(Cond1$SUS)
  shapiro.test(Cond2$SUS)
  shapiro.test(Cond3$SUS)
  shapiro.test(Cond4$SUS)
  
  shapiro.test(Cond1$SART)
  shapiro.test(Cond2$SART)
  shapiro.test(Cond3$SART)
  shapiro.test(Cond4$SART)
  
  shapiro.test(Cond1$Total_Glance_time)
  shapiro.test(Cond2$Total_Glance_time)
  shapiro.test(Cond3$Total_Glance_time)
  shapiro.test(Cond4$Total_Glance_time)
  
  shapiro.test(Cond1$Total_Glances)
  shapiro.test(Cond2$Total_Glances)
  shapiro.test(Cond3$Total_Glances)
  shapiro.test(Cond4$Total_Glances)
  
  shapiro.test(Cond1$Lane_Breaks)
  shapiro.test(Cond2$Lane_Breaks)
  shapiro.test(Cond3$Lane_Breaks)
  shapiro.test(Cond4$Lane_Breaks)
  
  shapiro.test(Cond1$Total_crash)
  shapiro.test(Cond2$Total_crash)
  shapiro.test(Cond3$Total_crash)
  shapiro.test(Cond4$Total_crash)
```
There are 8 scores which break normality  
Condition 1 - SUS  (0.001505)  
Condition 2 - SART (0.02632)  
Condition 2 - Total Glances (0.03561)  
Condition 3 - Lane breaks (0.03216)

Condition 1 - Total Crash (0.0001052)  
Condition 2 - Total Crash (0.0001063)  
Condition 3 - Total Crash (0.002371)  
Condition 4 - Total Crash (0.0001063)

Another way to present the crash data would be to score crashes pr condition:
```{r,echo=FALSE}
#OnlyCrashes <- subset(SartSusDemo, Total_crash >= 1,select=c(Condition, Total_crash))

TotalCrash <- ggplot(data=SartSusDemo, mapping=aes(x=Condition,y=Total_crash,fill=Condition))
TotalCrash <- TotalCrash + geom_col(col="black") + scale_y_continuous(name = "Crash count",breaks=c(0:15))+ ggtitle("Total Crash ") #+ scale_x_binned()

Palette <- "Set1"
TotalCrash + scale_fill_brewer(palette=Palette)
```
It can be seen on this graph that each condition has about the same total crashes and some conditions have one or two participants responsible for extra crashes.

```{r,echo=FALSE}
#The significantly not normally distributed metrics will be plottet with a qq plot to determnine how they are skewed

library("car")
q1 <- qqPlot(Cond1$SUS) 
# qqPlot(Cond2$SUS)
# qqPlot(Cond3$SUS)
# qqPlot(Cond4$SUS)

# qqPlot(Cond1$SART)
q2 <- qqPlot(Cond2$SART)
# qqPlot(Cond3$SART)
# qqPlot(Cond4$SART)
# 
# qqPlot(Cond1$Total_Glance_time)
# qqPlot(Cond2$Total_Glance_time)
# qqPlot(Cond3$Total_Glance_time)
# qqPlot(Cond4$Total_Glance_time)
# 
# qqPlot(Cond1$Total_Glances)
q3 <- qqPlot(Cond2$Total_Glances)
# qqPlot(Cond3$Total_Glances)
# qqPlot(Cond4$Total_Glances)
# 
# qqPlot(Cond1$Lane_Breaks)
# qqPlot(Cond2$Lane_Breaks)
q4 <- qqPlot(Cond3$Lane_Breaks)
# qqPlot(Cond4$Lane_Breaks)

q5<- qqPlot(Cond1$Total_crash)
q6<- qqPlot(Cond2$Total_crash)
q7<- qqPlot(Cond3$Total_crash)
q8<- qqPlot(Cond4$Total_crash)
```

### Test of homogeneity - Condition/metric
To test for homogeneity we'll use Levines test for the scores which aren't normally distributed and Bartletts test for the scores which are normally distributed.
```{r,echo=FALSE}
library(car)
SusVariance = leveneTest(SUS ~ Condition, SartSusDemo)
SartVariance = leveneTest(SART ~ Condition, SartSusDemo)
GlancesVariance = leveneTest(Total_Glances ~ Condition, SartSusDemo)
#GlanceTimevariance = leveneTest(Total_Glance_time ~ Condition, SartSusDemo)
Crashvariance = leveneTest(Total_crash ~ Condition, SartSusDemo)
LaneBreaksvariance = leveneTest(Lane_Breaks ~ Condition, SartSusDemo)

GlanceTimevariance <- bartlett.test(Total_Glance_time ~ Condition, data = SartSusDemo)

SusVariance
SartVariance
GlancesVariance
GlanceTimevariance
Crashvariance
LaneBreaksvariance
```
We see that the variance in metrics across the four conditions are not significantly different.

We now have two options  
1) Compute an ANOVA because it is said to be somewhat robust against violations of normal distribution  
2) Compute a Welsh ANOVA (it is robust against normal distribution but unequal variance (heteroscedastic))   
3) Compute a Kruskal-Wallis test - as our data has equal varience (homoscedasticity) but is not normally distributed  

We will choose option 3) and compute the Kruskal-Wallis test

```{r}
SUS <- kruskal.test(SUS ~ Condition, data = SartSusDemo)
SART <- kruskal.test(SART ~ Condition, data = SartSusDemo)
Glances <- kruskal.test(Total_Glances ~ Condition, data = SartSusDemo)
GlanceTime <- kruskal.test(Total_Glance_time ~ Condition, data = SartSusDemo)
Crashes <- kruskal.test(Total_crash ~ Condition, data = SartSusDemo)
LaneBreaks <- kruskal.test(Lane_Breaks ~ Condition, data = SartSusDemo)
# 
SUS
SART
Glances
GlanceTime
Crashes
LaneBreaks
```

### General metrics qqplot
To examine if the general metrics are normally distributed qqplots have been made for them.¨

```{r,echo=FALSE}
library("car")
qqPlot(SartSusDemo$SUS)
  shapiro.test(SartSusDemo$SUS)

qqPlot(SartSusDemo$SART)
  shapiro.test(SartSusDemo$SART)

qqPlot(SartSusDemo$Total_Glance_time)
  shapiro.test(SartSusDemo$Total_Glance_time)

qqPlot(SartSusDemo$Total_Glances)
  shapiro.test(SartSusDemo$Total_Glances)

qqPlot(SartSusDemo$Total_crash)
  shapiro.test(SartSusDemo$Total_crash)

qqPlot(SartSusDemo$Lane_Breaks)
  shapiro.test(SartSusDemo$Lane_Breaks)

```

<!-- ### Sammenhæng SART og SUS -->
```{r,echo=FALSE}
# SARTSUS <- lm(SUS ~ SART, data = SartSusDemo)
# summary(SARTSUS)
# ggplot(SartSusDemo,aes(SART, SUS,color=Condition)) + geom_point() + geom_smooth(method='lm',se=FALSE)
```
<!-- It is seen that the SART does not influence the SUS in a significant way. -->


## Plot of means - All Dependent variables vs All Independent variables
Dependent variables:  
- SUS  
- SART  
- Total Crash  
- Lane Breaks  
- Total Glances  
- Total Glance Time  
  
Independent variables:  
- Condition  
- Gender  
- Gaming  
- Drivers licence  (This plot will have a linear model underneath it (x=Years with drivers license y=Dependent variable))
- Automatic gear  
- Car Simulator

### SUS
```{r,echo=FALSE}
tgc <- summarySE(SartSusDemo, measurevar="SUS", groupvars=c("Condition"))

```
```{r,echo=FALSE}
# Use 95% confidence interval instead of SEM
plot1 <- ggplot(tgc, aes(x=Condition, y=SUS, colour=Condition)) + 
    geom_errorbar(aes(ymin=SUS-ci, ymax=SUS+ci), width=.1, position=pd) +
    geom_line(position=pd) +
    geom_point(position=pd)
```

```{r,echo=FALSE}
tgc <- summarySE(SartSusDemo, measurevar="SUS", groupvars=c("Gender"))
 
```
```{r ,echo=FALSE}
# Use 95% confidence interval instead of SEM
plot2 <- ggplot(tgc, aes(x=Gender, y=SUS, colour=Gender)) + 
    geom_errorbar(aes(ymin=SUS-ci, ymax=SUS+ci), width=.1, position=pd) +
    geom_line(position=pd) +
    geom_point(position=pd)


```

```{r,echo=FALSE}
tgc <- summarySE(SartSusDemo, measurevar="SUS", groupvars=c("ComputerGames"))
 
```
```{r,echo=FALSE}
# Use 95% confidence interval instead of SEM
plot3 <-ggplot(tgc, aes(x=ComputerGames, y=SUS, colour=ComputerGames)) + 
    geom_errorbar(aes(ymin=SUS-ci, ymax=SUS+ci), width=.1, position=pd) +
    geom_line(position=pd) +
    geom_point(position=pd)
```

```{r,echo=FALSE}
tgc <- summarySE(SartSusDemo, measurevar="SUS", groupvars=c("YearDriversLicence"))
 
```
```{r,echo=FALSE}
#Use 95% confidence interval instead of SEM
plot4 <- ggplot(tgc, aes(x=YearDriversLicence, y=SUS, colour=YearDriversLicence)) + 
     geom_errorbar(aes(ymin=SUS-ci, ymax=SUS+ci), width=.1, position=pd) +
     geom_line(position=pd) +
      geom_point(position=pd)


x<-SartSusDemo$YearDriversLicence
y<-SartSusDemo$SUS

model <- lm(y~x, data=SartSusDemo)
plot4 <- ggplot(SartSusDemo,aes(x, y,color=Condition)) + geom_point() + geom_smooth(method='lm',se=FALSE) 
plot4
 

```

```{r,echo=FALSE}
tgc <- summarySE(SartSusDemo, measurevar="SUS", groupvars=c("SimulatorExperience"))
 
```
```{r,echo=FALSE}
# Use 95% confidence interval instead of SEM
plot5 <-ggplot(tgc, aes(x=SimulatorExperience, y=SUS, colour=SimulatorExperience)) + 
    geom_errorbar(aes(ymin=SUS-ci, ymax=SUS+ci), width=.1, position=pd) +
    geom_line(position=pd) +
    geom_point(position=pd)
```

```{r,echo=FALSE}
tgc <- summarySE(SartSusDemo, measurevar="SUS", groupvars=c("Automatic"))
 
```
```{r,echo=FALSE}
# Use 95% confidence interval instead of SEM
plot6 <-ggplot(tgc, aes(x=Automatic, y=SUS, colour=Automatic)) + 
    geom_errorbar(aes(ymin=SUS-ci, ymax=SUS+ci), width=.1, position=pd) +
    geom_line(position=pd) +
    geom_point(position=pd)
```

```{r}
  SaveSixPlots(Metric="SUS")
```


### Sart
```{r,echo=FALSE}
tgc <- summarySE(SartSusDemo, measurevar="SART", groupvars=c("Condition"))
 
```
```{r,echo=FALSE}
# Use 95% confidence interval instead of SEM
plot1 <- ggplot(tgc, aes(x=Condition, y=SART, colour=Condition)) + 
    geom_errorbar(aes(ymin=SART-ci, ymax=SART+ci), width=.1, position=pd) +
    geom_line(position=pd) +
    geom_point(position=pd)
```

```{r,echo=FALSE}
tgc <- summarySE(SartSusDemo, measurevar="SART", groupvars=c("Gender"))
 
```
```{r,echo=FALSE}
# Use 95% confidence interval instead of SEM
plot2 <- ggplot(tgc, aes(x=Gender, y=SART, colour=Gender)) + 
    geom_errorbar(aes(ymin=SART-ci, ymax=SART+ci), width=.1, position=pd) +
    geom_line(position=pd) +
    geom_point(position=pd)
```

```{r,echo=FALSE}
tgc <- summarySE(SartSusDemo, measurevar="SART", groupvars=c("ComputerGames"))
 
```
```{r,echo=FALSE}
# Use 95% confidence interval instead of SEM
plot3 <- ggplot(tgc, aes(x=ComputerGames, y=SART, colour=ComputerGames)) + 
    geom_errorbar(aes(ymin=SART-ci, ymax=SART+ci), width=.1, position=pd) +
    geom_line(position=pd) +
    geom_point(position=pd)
```

```{r,echo=FALSE}
  tgc <- summarySE(SartSusDemo, measurevar="SART", groupvars=c("YearDriversLicence"))
   
```
```{r,echo=FALSE}
  #Use 95% confidence interval instead of SEM
  plot4 <- ggplot(tgc, aes(x=YearDriversLicence, y=SART, colour=YearDriversLicence)) + 
      geom_errorbar(aes(ymin=SART-ci, ymax=SART+ci), width=.1, position=pd) +
      geom_line(position=pd) +
      geom_point(position=pd)

x<-SartSusDemo$YearDriversLicence
y<-SartSusDemo$SART
model <- lm(y~x, data=SartSusDemo)
plot4 <- ggplot(SartSusDemo,aes(x, y,color=Condition)) + geom_point()+ geom_smooth(method='lm',se=FALSE) 
#plot4
  
```

```{r,echo=FALSE}
tgc <- summarySE(SartSusDemo, measurevar="SART", groupvars=c("SimulatorExperience"))
 
```
```{r,echo=FALSE}
# Use 95% confidence interval instead of SEM
plot5 <- ggplot(tgc, aes(x=SimulatorExperience, y=SART, colour=SimulatorExperience)) + 
    geom_errorbar(aes(ymin=SART-ci, ymax=SART+ci), width=.1, position=pd) +
    geom_line(position=pd) +
    geom_point(position=pd)
```

```{r,echo=FALSE}
tgc <- summarySE(SartSusDemo, measurevar="SART", groupvars=c("Automatic"))
 
```
```{r,echo=FALSE}
# Use 95% confidence interval instead of SEM
plot6 <- ggplot(tgc, aes(x=Automatic, y=SART, colour=Automatic)) + 
    geom_errorbar(aes(ymin=SART-ci, ymax=SART+ci), width=.1, position=pd) +
    geom_line(position=pd) +
    geom_point(position=pd)
```
```{r}
  SaveSixPlots("SART")
```
### Total crash
```{r,echo=FALSE}
tgc <- summarySE(SartSusDemo, measurevar="Total_crash", groupvars=c("Condition"))
 
```
```{r,echo=FALSE}
# Use 95% confidence interval instead of SEM
plot1 <- ggplot(tgc, aes(x=Condition, y=Total_crash, colour=Condition)) + 
    geom_errorbar(aes(ymin=Total_crash-ci, ymax=Total_crash+ci), width=.1, position=pd) +
    geom_line(position=pd) +
    geom_point(position=pd)
```

```{r,echo=FALSE}
tgc <- summarySE(SartSusDemo, measurevar="Total_crash", groupvars=c("Gender"))
 
```
```{r,echo=FALSE}
# Use 95% confidence interval instead of SEM
plot2 <- ggplot(tgc, aes(x=Gender, y=Total_crash, colour=Gender)) + 
    geom_errorbar(aes(ymin=Total_crash-ci, ymax=Total_crash+ci), width=.1, position=pd) +
    geom_line(position=pd) +
    geom_point(position=pd)
```

```{r,echo=FALSE}
tgc <- summarySE(SartSusDemo, measurevar="Total_crash", groupvars=c("ComputerGames"))
 
```
```{r,echo=FALSE}
# Use 95% confidence interval instead of SEM
plot3 <- ggplot(tgc, aes(x=ComputerGames, y=Total_crash, colour=ComputerGames)) + 
    geom_errorbar(aes(ymin=Total_crash-ci, ymax=Total_crash+ci), width=.1, position=pd) +
    geom_line(position=pd) +
    geom_point(position=pd)
```

```{r,echo=FALSE}
  tgc <- summarySE(SartSusDemo, measurevar="Total_crash", groupvars=c("YearDriversLicence"))
   
```
```{r,echo=FALSE}
  #Use 95% confidence interval instead of SEM
  plot4 <- ggplot(tgc, aes(x=YearDriversLicence, y=Total_crash, colour=YearDriversLicence)) + 
      geom_errorbar(aes(ymin=Total_crash-ci, ymax=Total_crash+ci), width=.1, position=pd) +
      geom_line(position=pd) +
      geom_point(position=pd)

x<-SartSusDemo$YearDriversLicence
y<-SartSusDemo$Total_crash
model <- lm(y~x, data=SartSusDemo)
plot4 <- ggplot(SartSusDemo,aes(x, y,color=Condition)) + geom_point() + geom_smooth(method='lm',se=FALSE) 
#plot4
  
```

```{r,echo=FALSE}
tgc <- summarySE(SartSusDemo, measurevar="Total_crash", groupvars=c("SimulatorExperience"))
 
```
```{r,echo=FALSE}
# Use 95% confidence interval instead of SEM
plot5 <- ggplot(tgc, aes(x=SimulatorExperience, y=Total_crash, colour=SimulatorExperience)) + 
    geom_errorbar(aes(ymin=Total_crash-ci, ymax=Total_crash+ci), width=.1, position=pd) +
    geom_line(position=pd) +
    geom_point(position=pd)
```

```{r,echo=FALSE}
tgc <- summarySE(SartSusDemo, measurevar="Total_crash", groupvars=c("Automatic"))
 
```
```{r,echo=FALSE}
# Use 95% confidence interval instead of SEM
plot6 <- ggplot(tgc, aes(x=Automatic, y=Total_crash, colour=Automatic)) + 
    geom_errorbar(aes(ymin=Total_crash-ci, ymax=Total_crash+ci), width=.1, position=pd) +
    geom_line(position=pd) +
    geom_point(position=pd)
```
```{r}
  SaveSixPlots("Total_crash")
```

### Lane Breaks
```{r,echo=FALSE}
tgc <- summarySE(SartSusDemo, measurevar="Lane_Breaks", groupvars=c("Condition"))
 
```
```{r,echo=FALSE}
# Use 95% confidence interval instead of SEM
plot1 <- ggplot(tgc, aes(x=Condition, y=Lane_Breaks, colour=Condition)) + 
    geom_errorbar(aes(ymin=Lane_Breaks-ci, ymax=Lane_Breaks+ci), width=.1, position=pd) +
    geom_line(position=pd) +
    geom_point(position=pd)
```

```{r,echo=FALSE}
tgc <- summarySE(SartSusDemo, measurevar="Lane_Breaks", groupvars=c("Gender"))
 
```
```{r,echo=FALSE}
# Use 95% confidence interval instead of SEM
plot2 <- ggplot(tgc, aes(x=Gender, y=Lane_Breaks, colour=Gender)) + 
    geom_errorbar(aes(ymin=Lane_Breaks-ci, ymax=Lane_Breaks+ci), width=.1, position=pd) +
    geom_line(position=pd) +
    geom_point(position=pd)
```

```{r,echo=FALSE}
tgc <- summarySE(SartSusDemo, measurevar="Lane_Breaks", groupvars=c("ComputerGames"))
 
```
```{r,echo=FALSE}
# Use 95% confidence interval instead of SEM
plot3 <- ggplot(tgc, aes(x=ComputerGames, y=Lane_Breaks, colour=ComputerGames)) + 
    geom_errorbar(aes(ymin=Lane_Breaks-ci, ymax=Lane_Breaks+ci), width=.1, position=pd) +
    geom_line(position=pd) +
    geom_point(position=pd)
```

```{r,echo=FALSE}
  tgc <- summarySE(SartSusDemo, measurevar="Lane_Breaks", groupvars=c("YearDriversLicence"))
   
```
```{r,echo=FALSE}
  #Use 95% confidence interval instead of SEM
  plot4 <- ggplot(tgc, aes(x=YearDriversLicence, y=Lane_Breaks, colour=YearDriversLicence)) + 
      geom_errorbar(aes(ymin=Lane_Breaks-ci, ymax=Lane_Breaks+ci), width=.1, position=pd) +
      geom_line(position=pd) +
      geom_point(position=pd)

x<-SartSusDemo$YearDriversLicence
y<-SartSusDemo$Lane_Breaks
model <- lm(y~x, data=SartSusDemo)
plot4 <- ggplot(SartSusDemo,aes(x, y,color=Condition)) + geom_point() + geom_smooth(method='lm',se=FALSE) 
#plot4
  
```

```{r,echo=FALSE}
tgc <- summarySE(SartSusDemo, measurevar="Lane_Breaks", groupvars=c("SimulatorExperience"))
 
```
```{r,echo=FALSE}
# Use 95% confidence interval instead of SEM
plot5<- ggplot(tgc, aes(x=SimulatorExperience, y=Lane_Breaks, colour=SimulatorExperience)) + 
    geom_errorbar(aes(ymin=Lane_Breaks-ci, ymax=Lane_Breaks+ci), width=.1, position=pd) +
    geom_line(position=pd) +
    geom_point(position=pd)
```

```{r,echo=FALSE}
tgc <- summarySE(SartSusDemo, measurevar="Lane_Breaks", groupvars=c("Automatic"))
 
```
```{r,echo=FALSE}
# Use 95% confidence interval instead of SEM
plot6<- ggplot(tgc, aes(x=Automatic, y=Lane_Breaks, colour=Automatic)) + 
    geom_errorbar(aes(ymin=Lane_Breaks-ci, ymax=Lane_Breaks+ci), width=.1, position=pd) +
    geom_line(position=pd) +
    geom_point(position=pd)
```
```{r}
  SaveSixPlots("Lane_Breaks")
```

### Total Glances
```{r,echo=FALSE}
tgc <- summarySE(SartSusDemo, measurevar="Total_Glances", groupvars=c("Condition"))
 
```
```{r,echo=FALSE}
# Use 95% confidence interval instead of SEM
plot1<- ggplot(tgc, aes(x=Condition, y=Total_Glances, colour=Condition)) + 
    geom_errorbar(aes(ymin=Total_Glances-ci, ymax=Total_Glances+ci), width=.1, position=pd) +
    geom_line(position=pd) +
    geom_point(position=pd)
```

```{r,echo=FALSE}
tgc <- summarySE(SartSusDemo, measurevar="Total_Glances", groupvars=c("Gender"))
 
```
```{r,echo=FALSE}
# Use 95% confidence interval instead of SEM
plot2<- ggplot(tgc, aes(x=Gender, y=Total_Glances, colour=Gender)) + 
    geom_errorbar(aes(ymin=Total_Glances-ci, ymax=Total_Glances+ci), width=.1, position=pd) +
    geom_line(position=pd) +
    geom_point(position=pd)
```

```{r,echo=FALSE}
tgc <- summarySE(SartSusDemo, measurevar="Total_Glances", groupvars=c("ComputerGames"))
 
```
```{r,echo=FALSE}
# Use 95% confidence interval instead of SEM
plot3<- ggplot(tgc, aes(x=ComputerGames, y=Total_Glances, colour=ComputerGames)) + 
    geom_errorbar(aes(ymin=Total_Glances-ci, ymax=Total_Glances+ci), width=.1, position=pd) +
    geom_line(position=pd) +
    geom_point(position=pd)
```

```{r,echo=FALSE}
  tgc <- summarySE(SartSusDemo, measurevar="Total_Glances", groupvars=c("YearDriversLicence"))
   
```
```{r,echo=FALSE}
  #Use 95% confidence interval instead of SEM
  plot4<- ggplot(tgc, aes(x=YearDriversLicence, y=Total_Glances, colour=YearDriversLicence)) + 
      geom_errorbar(aes(ymin=Total_Glances-ci, ymax=Total_Glances+ci), width=.1, position=pd) +
      geom_line(position=pd) +
      geom_point(position=pd)


x<-SartSusDemo$YearDriversLicence
y<-SartSusDemo$Total_Glances
model <- lm(y~x, data=SartSusDemo)
plot4 <- ggplot(SartSusDemo,aes(x, y,color=Condition)) + geom_point() + geom_smooth(method='lm',se=FALSE) 
#plot4
  
```

```{r,echo=FALSE}
tgc <- summarySE(SartSusDemo, measurevar="Total_Glances", groupvars=c("SimulatorExperience"))
 
```
```{r,echo=FALSE}
# Use 95% confidence interval instead of SEM
plot5<- ggplot(tgc, aes(x=SimulatorExperience, y=Total_Glances, colour=SimulatorExperience)) + 
    geom_errorbar(aes(ymin=Total_Glances-ci, ymax=Total_Glances+ci), width=.1, position=pd) +
    geom_line(position=pd) +
    geom_point(position=pd)
```

```{r,echo=FALSE}
tgc <- summarySE(SartSusDemo, measurevar="Total_Glances", groupvars=c("Automatic"))
 
```
```{r,echo=FALSE}
# Use 95% confidence interval instead of SEM
plot6<- ggplot(tgc, aes(x=Automatic, y=Total_Glances, colour=Automatic)) + 
    geom_errorbar(aes(ymin=Total_Glances-ci, ymax=Total_Glances+ci), width=.1, position=pd) +
    geom_line(position=pd) +
    geom_point(position=pd)
```

```{r}
  SaveSixPlots("Total_Glances")
```
### Total Glance time 
```{r,echo=FALSE}
tgc <- summarySE(SartSusDemo, measurevar="Total_Glance_time", groupvars=c("Condition"))
 
```
```{r,echo=FALSE}
# Use 95% confidence interval instead of SEM
plot1<- ggplot(tgc, aes(x=Condition, y=Total_Glance_time, colour=Condition)) + 
    geom_errorbar(aes(ymin=Total_Glance_time-ci, ymax=Total_Glance_time+ci), width=.1, position=pd) +
    geom_line(position=pd) +
    geom_point(position=pd)
```

```{r,echo=FALSE}
tgc <- summarySE(SartSusDemo, measurevar="Total_Glance_time", groupvars=c("Gender"))
 
```
```{r,echo=FALSE}
# Use 95% confidence interval instead of SEM
plot2<- ggplot(tgc, aes(x=Gender, y=Total_Glance_time, colour=Gender)) + 
    geom_errorbar(aes(ymin=Total_Glance_time-ci, ymax=Total_Glance_time+ci), width=.1, position=pd) +
    geom_line(position=pd) +
    geom_point(position=pd)
```

```{r,echo=FALSE}
tgc <- summarySE(SartSusDemo, measurevar="Total_Glance_time", groupvars=c("ComputerGames"))
 
```
```{r,echo=FALSE}
# Use 95% confidence interval instead of SEM
plot3<- ggplot(tgc, aes(x=ComputerGames, y=Total_Glance_time, colour=ComputerGames)) + 
    geom_errorbar(aes(ymin=Total_Glance_time-ci, ymax=Total_Glance_time+ci), width=.1, position=pd) +
    geom_line(position=pd) +
    geom_point(position=pd)
```

```{r,echo=FALSE}
  tgc <- summarySE(SartSusDemo, measurevar="Total_Glance_time", groupvars=c("YearDriversLicence"))
   
```
```{r,echo=FALSE}
# Use 95% confidence interval instead of SEM
  plot4<- ggplot(tgc, aes(x=YearDriversLicence, y=Total_Glance_time, colour=YearDriversLicence)) + 
      geom_errorbar(aes(ymin=Total_Glance_time-ci, ymax=Total_Glance_time+ci), width=.1, position=pd) +
      geom_line(position=pd) +
      geom_point(position=pd)

x<-SartSusDemo$YearDriversLicence
y<-SartSusDemo$Total_Glance_time
model <- lm(y~x, data=SartSusDemo)
plot4 <- ggplot(SartSusDemo,aes(x, y,color=Condition)) + geom_point() + geom_smooth(method='lm',se=FALSE) 
#plot4
  
```

```{r,echo=FALSE}
tgc <- summarySE(SartSusDemo, measurevar="Total_Glance_time", groupvars=c("SimulatorExperience"))
 
```
```{r,echo=FALSE}
# Use 95% confidence interval instead of SEM
plot5<- ggplot(tgc, aes(x=SimulatorExperience, y=Total_Glance_time, colour=SimulatorExperience)) + 
    geom_errorbar(aes(ymin=Total_Glance_time-ci, ymax=Total_Glance_time+ci), width=.1, position=pd) +
    geom_line(position=pd) +
    geom_point(position=pd)
```

```{r,echo=FALSE}
tgc <- summarySE(SartSusDemo, measurevar="Total_Glance_time", groupvars=c("Automatic"))
 
```
```{r,echo=FALSE}
# Use 95% confidence interval instead of SEM
plot6<- ggplot(tgc, aes(x=Automatic, y=Total_Glance_time, colour=Automatic)) + 
    geom_errorbar(aes(ymin=Total_Glance_time-ci, ymax=Total_Glance_time+ci), width=.1, position=pd) +
    geom_line(position=pd) +
    geom_point(position=pd)
```

```{r,echo=FALSE}
  SaveSixPlots("Total_Glance_Time")
```

<!-- ## Boxplots -->

```{r,echo=FALSE}
# library(ggplot2)
# SusCondition=ggplot(data=SartSusDemo, mapping=aes(x=Condition, y=SUS,fill = Condition))+geom_boxplot()
# SartCondition=ggplot(data=SartSusDemo, mapping=aes(x=Condition, y=SART,fill = Condition))+geom_boxplot()
# SusGender=ggplot(data=SartSusDemo, mapping=aes(x=Gender, y=SUS,fill = Gender))+geom_boxplot()
# SartGender=ggplot(data=SartSusDemo, mapping=aes(x=Gender, y=SART,fill = Gender))+geom_boxplot()
# SusComputerGames=ggplot(data=SartSusDemo, mapping=aes(x=ComputerGames, y=SUS,fill = ComputerGames))+geom_boxplot()
# SartComputerGames=ggplot(data=SartSusDemo, mapping=aes(x=ComputerGames, y=SART,fill = ComputerGames))+geom_boxplot()
# 
# SusCondition
# SartCondition
# SusGender
# SartGender
# SusComputerGames
# SartComputerGames
```


##T-tests
```{r,include=FALSE}
# Combi <- SartSusDemo[which(SartSusDemo$Condition=='Combination'),]
# Touch <- SartSusDemo[which(SartSusDemo$Condition=='Touch_only'),]
# Bar <- SartSusDemo[which(SartSusDemo$Condition=='Bar'),]
# Acrylic <- SartSusDemo[which(SartSusDemo$Condition=='Acrylic'),]
# 
# CombiTouch <- subset(SartSusDemo, Condition=='Combination' | Condition=='Touch_only', 
# select=c(Participants, SUS,Condition))
# 
# 
# TSusCondition = t.test(formula = SUS ~ Condition, data = CombiTouch)
# TSusCondition
# 
# one.way <- aov(SUS ~ Condition, data = SartSusDemo)
# summary(one.way)

```

## From the many plot of means with confidence interval 95% as wisksers we've determined to test the following interactions

```{r}
LaneBreaksAutomatic  <- t.test(formula = Lane_Breaks ~ Automatic, data = SartSusDemo)
SartGender <- t.test(formula = SART ~ Gender, data = SartSusDemo)
CrashComputer <- aov(formula = Total_crash ~ ComputerGames, data = SartSusDemo)
CrashAutomatic <- t.test(formula = Total_crash ~ Automatic, data = SartSusDemo)
GlanceTimeAutomatic <- t.test(formula = Total_Glance_time ~ Automatic, data = SartSusDemo)
GlanceCondition <- aov(formula = Total_Glance_time ~ Condition, data = SartSusDemo)
GlancesGender <- t.test(formula = Total_Glances ~ Gender, data = SartSusDemo)
GlancesAutomatic <- t.test(formula = Total_Glances ~ Automatic, data = SartSusDemo)

#Måske er der noget med glances og condition
attach(SartSusDemo)
GlancesCondition <- pairwise.t.test(Total_Glances, Condition,p.adj = "bonf")
detach()

 LaneBreaksAutomatic
 SartGender
 summary(CrashComputer)
 CrashAutomatic
 GlanceTimeAutomatic
 summary(GlanceCondition)
 GlancesGender
 GlancesAutomatic
 GlancesCondition

 

```

When analysing this much data the risk of p-hacking increases. We'll only use these significanses if there is a big heteroscedasticity in regards to the four conditions maybe this change can explain 

The four significant effects were:  
1) Lane_Breaks by Automatic 0.01666  
2) Total_Glance_time by Automatic 0.007043  

```{r}
AutomaticExperienceCondition
```
Automatic experience is distributed quite nice with a difference of 2 between highest and lowest.
Therefore this effect is irrelevant.  
3) SART by Gender 0.02699 
```{r}
GenderCondition
```
Gender  is distributed with a difference of 1 between highest and lowest.
Therefore this effect is irrelevant
