---
title: "Tactile navigation"
author: "Jeppe"
date: '2023-05-01'
output: html_document
editor_options: 
  markdown: 
    wrap: 72
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE)

knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(readxl)
library(plyr)
library(cowplot)
library("car")
library(car)
library(rstatix)
library(datarium)
library(readr)

# import data
urlfile <- "https://raw.githubusercontent.com/JeppeGivskud/P6-Tactile-Navigation/main/Datasheet_last_rows.csv"
dataFrame <- read.csv(url(urlfile), header = TRUE, stringsAsFactors = TRUE)

# Farven på alle plots er defineret ud fra palette
Palette <- "Set1"
```

```{r,echo=FALSE} 
## Gives count, mean, standard deviation, standard error of the mean, and confidence interval (default 95%).
##   data: a data frame.
##   measurevar: the name of a column that contains the variable to be summariezed
##   groupvars: a vector containing names of columns that contain grouping variables
##   na.rm: a boolean that indicates whether to ignore NA's
##   conf.interval: the percent range of the confidence interval (default is 95%)
summarySE <- function(data = NULL, measurevar, groupvars = NULL, na.rm = FALSE,
                      conf.interval = .95, .drop = TRUE) {
    # New version of length which can handle NA's: if na.rm==T, don't count them
    length2 <- function(x, na.rm = FALSE) {
        if (na.rm) {
            sum(!is.na(x))
        } else {
            length(x)
        }
    }

    # This does the summary. For each group's data frame, return a vector with
    # N, mean, and sd
    datac <- ddply(data, groupvars,
        .drop = .drop,
        .fun = function(xx, col) {
            c(
                N = length2(xx[[col]], na.rm = na.rm),
                mean = mean(xx[[col]], na.rm = na.rm),
                sd = sd(xx[[col]], na.rm = na.rm)
            )
        },
        measurevar
    )

    # Rename the "mean" column
    datac <- rename(datac, c("mean" = measurevar))

    datac$se <- datac$sd / sqrt(datac$N) # Calculate standard error of the mean

    # Confidence interval multiplier for standard error
    # Calculate t-statistic for confidence interval:
    # e.g., if conf.interval is .95, use .975 (above/below), and use df=N-1
    ciMult <- qt(conf.interval / 2 + .5, datac$N - 1)
    datac$ci <- datac$se * ciMult

    return(datac)
}
pd <- position_dodge(0.1) # move them .05 to the left and right
```
```{r, include=FALSE}
dev.new(width = 5, height = 4, noRStudioGD = TRUE)

SaveSixPlots <- function(Metric = "NULL", filetype = ".pdf") {
    Palette <- "Set1"

    plot1 <- plot1 + scale_colour_brewer(palette = Palette)
    plot2 <- plot2 + scale_colour_brewer(palette = Palette)
    plot3 <- plot3 + scale_colour_brewer(palette = Palette)
    plot4 <- plot4 #+ scale_colour_brewer(palette=Palette)
    plot5 <- plot5 + scale_colour_brewer(palette = Palette)
    plot6 <- plot6 + scale_colour_brewer(palette = Palette)

    dir.create(Metric)
    title1 <- paste(Metric, "-1-Condition", filetype, sep = "", collapse = NULL)
    title2 <- paste(Metric, "-2-Gender", filetype, sep = "", collapse = NULL)
    title3 <- paste(Metric, "-3-ComputerGames", filetype, sep = "", collapse = NULL)
    title4 <- paste(Metric, "-4-YearsDriversLicence", filetype, sep = "", collapse = NULL)
    title5 <- paste(Metric, "-5-SimulatorExperience", filetype, sep = "", collapse = NULL)
    title6 <- paste(Metric, "-6-Automatic", filetype, sep = "", collapse = NULL)

    ggsave(filename = title1, plot = plot1, path = Metric)
    ggsave(filename = title2, plot = plot2, path = Metric)
    ggsave(filename = title3, plot = plot3, path = Metric)
    ggsave(filename = title4, plot = plot4, path = Metric)
    ggsave(filename = title5, plot = plot5, path = Metric)
    ggsave(filename = title6, plot = plot6, path = Metric)


    plot1
    plot2
    plot3
    plot4
    summary(model)
    plot5
    plot6
    out <- list(plot1, plot2, plot3, plot4, summary(model), plot5, plot6)
    return(out)
}
```

## Introduction
A study on driving performance and In Vehicle infotainment system has been done. The study aims to answer two questions.
1) Can the addition of tactile navigation improve driving performance
2) Which tactile navigation (if any) improves driving performance most

The first part of this statistical analysis aims to investigate the sample to answer if the data is normally distributed and if the participants's characteristics are distributed across the four conditions. If this is not the case an effect of condition could be attributed to other personal factors of the participants (e.g. gaming experience).

Dependent variables:  
- SUS  
- SART  
- Total Crash  
- Lane Breaks  
- Total Glances  
- Total Glance Time  
  
Independent variable:  
- Condition (Acrylic, Bar, Combination & Touch only)

Demographics:  
- Age  
- Gender  
- Gaming  
- Drivers licence Years  
- Automatic gear experience  
- Car Simulator  

## Population
```{r, echo=FALSE} 
#                         !!!LÆS DETTE FOR AT FORSTÅ!!!
# Der bruges forskellige funktioner i disse plots.
# Den første funktion ggplot vælger data og x og y akser. Eksempelevis x=condition og så fylder den farve på efter gender.
# Geom bar gør at plottet er et barplot med en stregtykkelse
# Scale_y_continuous gør at man kan ændre y aksen med label og hakker
# scale_y_discrete gør man kan ændre y aksen med label og labels (for konditioner)
# scale_x_binned deler yeardriverslicence op i 16 grupper
# scale_fill_discrete gør man kan ændre labels på legend med titel og konditioner
# ggtitle ændrer titel
# Siden titlerne er ændret skal man lige fjerne dem og se om der er byttet rundt på konditioner. Man kan nemlig godt kalde bar for acrylic og så bliver vi forvirret
```

```{r, echo=FALSE} 
GenderCondition <- ggplot(data = dataFrame, mapping = aes(x = Condition, fill = Gender))
GenderCondition <- GenderCondition + geom_bar(col = "black", size = .3) + scale_y_continuous(name = "Count", breaks = c(0:15)) + ggtitle("Gender and Condition") + scale_fill_brewer(palette = Palette)

AgeCondition <- ggplot(data = dataFrame, mapping = aes(x = Age, fill = Condition))
AgeCondition <- AgeCondition + geom_bar(col = "black", size = .3) + scale_y_continuous(name = "Count", breaks = c(0:15)) + scale_x_continuous(breaks = c(20:34)) + scale_fill_discrete(name = "Condition") + ggtitle("Age and Condition") + scale_fill_brewer(palette = Palette)

ComputerCondition <- ggplot(data = dataFrame, mapping = aes(x = Condition, fill = ComputerGames))
ComputerCondition <- ComputerCondition + geom_bar(col = "black", size = .3) + scale_y_continuous(name = "Count", breaks = c(0:15)) + scale_fill_discrete(name = "Computer gaming (Hours)") + ggtitle("General gaming pr. week and Condition") + scale_fill_brewer(palette = Palette)

DrivingCondition <- ggplot(data = dataFrame, mapping = aes(x = YearDriversLicence, fill = Condition))
DrivingCondition <- DrivingCondition + geom_bar(col = "black", size = .3) + scale_y_continuous(name = "Count", breaks = c(0:15)) + scale_x_binned(n.breaks = 20) + scale_fill_discrete(name = "Condition") + ggtitle("Years with drivers licence and Condition") + scale_fill_brewer(palette = Palette)

SimulatorYesNoExperienceCondition <- ggplot(data = dataFrame, mapping = aes(x = Condition, fill = SimulatorExperience))
SimulatorYesNoExperienceCondition <- SimulatorYesNoExperienceCondition + geom_bar(col = "black", size = .3) + scale_y_continuous(name = "Count", breaks = c(0:15)) + scale_fill_discrete(name = "Car simulator experience (Y/N)") + ggtitle("Car simulator experience and Condition") + scale_fill_brewer(palette = Palette)

CarGamesCondition <- ggplot(data = dataFrame, mapping = aes(x = Condition, fill = CarGames))
CarGamesCondition <- CarGamesCondition + geom_bar(col = "black", size = .3) + scale_y_continuous(name = "Count", breaks = c(0:15)) + scale_fill_discrete(name = "Car gaming (Hours)") + ggtitle("Car gaming pr. week and Condition") + scale_fill_brewer(palette = Palette)

CarSimulatorExperienceCondition <- ggplot(data = dataFrame, mapping = aes(x = Condition, fill = CarSimulators))
CarSimulatorExperienceCondition <- CarSimulatorExperienceCondition + geom_bar(col = "black", size = .3) + scale_y_continuous(name = "Count", breaks = c(0:15)) + scale_fill_discrete(name = "Car simulator gaming (Hours)") + ggtitle("Car simulator pr. week and Condition") + scale_fill_brewer(palette = Palette)

AutomaticExperienceCondition <- ggplot(data = dataFrame, mapping = aes(x = Condition, fill = Automatic))
AutomaticExperienceCondition <- AutomaticExperienceCondition + geom_bar(col = "black", size = .3) + scale_y_continuous(name = "Count", breaks = c(0:15)) + scale_fill_discrete(name = "Automatic experience  (Y/N)") + ggtitle("Automatic experience and Condition") + scale_fill_brewer(palette = Palette)

GenderCondition + scale_fill_brewer(palette = Palette)
AgeCondition + scale_fill_brewer(palette = Palette)
ComputerCondition + scale_fill_brewer(palette = Palette)
DrivingCondition + scale_fill_brewer(palette = Palette)
SimulatorYesNoExperienceCondition + scale_fill_brewer(palette = Palette)
CarGamesCondition + scale_fill_brewer(palette = Palette)
AutomaticExperienceCondition + scale_fill_brewer(palette = Palette)
CarSimulatorExperienceCondition + scale_fill_brewer(palette = Palette)
```


```{r, echo=FALSE}  
# Levenes test for homoscidaddle med hensyn til condition og demographics
# attach(dataFrame)
# AgeHomo <-  leveneTest(Age ~ Condition, dataFrame)
# YearHomo = leveneTest(YearDriversLicence ~ Condition, dataFrame)
# pvalue <- AgeHomo$`Pr(>F)`
# AgeCondition <-AgeCondition + geom_text(data=AgeHomo,aes(x =1,y = 1, label = paste("italic(R)^2", "==", pvalue)))
# AgeHomo
# YearHomo
# AgeCondition
```


A summary of 'Age' and 'Years with drivers licence'. As with the bar graph for age we have a lot of people between 20-23 and most participants have had a drivers licence for 3-5 years.
```{r, echo=TRUE} 
Agessummary <- summary(dataFrame[c("Age")])

Drivingsummary <- summary(dataFrame[c("YearDriversLicence")])

Metricsummary <- summary(dataFrame[c("SART", "SUS", "TotalGlanceTime", "TotalGlances", "TotalCrash", "LaneBreaks")])

Agessummary
sd(dataFrame$Age)

Drivingsummary
sd(dataFrame$YearDriversLicence)
```

```{r,echo=FALSE}
dev.new(width = 5, height = 4, noRStudioGD = TRUE)

Metric <- "Demographics"
dir.create(Metric)
ggsave(filename = "GenderCondition.pdf", plot = GenderCondition, path = Metric)
ggsave(filename = "AgeCondition.png", plot = AgeCondition, path = Metric)
ggsave(filename = "ComputerCondition.pdf", plot = ComputerCondition, path = Metric)
ggsave(filename = "DrivingCondition.png", plot = DrivingCondition, path = Metric)
ggsave(filename = "SimulatorYesNoExperienceCondition.pdf", plot = SimulatorYesNoExperienceCondition, path = Metric)
ggsave(filename = "CarGamesCondition.pdf", plot = CarGamesCondition, path = Metric)
ggsave(filename = "AutomaticExperienceCondition.pdf", plot = AutomaticExperienceCondition, path = Metric)
ggsave(filename = "CarSimulatorExperienceCondition.pdf", plot = CarSimulatorExperienceCondition, path = Metric)
```

## Effect due to condition
To answer the first question of whether condition have an effect on the 6 metrics we'll create a plot of means with confidence (95%) as whiskers. According to Geoff Cumming and Sue Finch if the data has the same standard deviation it is possible to gain insight into which data could be significantly different.

### Plot of means Condition/metric
```{r,echo=FALSE}
tgc <- summarySE(dataFrame, measurevar = "SUS", groupvars = c("Condition"))
```
```{r,echo=FALSE}
# Use 95% confidence interval instead of SEM
SusCondition <- ggplot(tgc, aes(x = Condition, y = SUS, colour = Condition)) +
    geom_errorbar(aes(ymin = SUS - ci, ymax = SUS + ci), width = .1, position = pd) +
    geom_line(position = pd) +
    geom_point(position = pd)
plot1 <- SusCondition + scale_colour_brewer(palette = Palette)
```
```{r,echo=FALSE}
tgc <- summarySE(dataFrame, measurevar = "SART", groupvars = c("Condition"))
```
```{r,echo=FALSE}
# Use 95% confidence interval instead of SEM
SartCondition <- ggplot(tgc, aes(x = Condition, y = SART, colour = Condition)) +
    geom_errorbar(aes(ymin = SART - ci, ymax = SART + ci), width = .1, position = pd) +
    geom_line(position = pd) +
    geom_point(position = pd)
plot2 <- SartCondition + scale_colour_brewer(palette = Palette)
```
```{r,echo=FALSE}
tgc <- summarySE(dataFrame, measurevar = "TotalCrash", groupvars = c("Condition"))
```
```{r,echo=FALSE}
# Use 95% confidence interval instead of SEM
CrashCondition <- ggplot(tgc, aes(x = Condition, y = TotalCrash, colour = Condition)) +
    geom_errorbar(aes(ymin = TotalCrash - ci, ymax = TotalCrash + ci), width = .1, position = pd) +
    geom_line(position = pd) +
    geom_point(position = pd)
plot3 <- CrashCondition + scale_colour_brewer(palette = Palette)
```
```{r,echo=FALSE}
tgc <- summarySE(dataFrame, measurevar = "LaneBreaks", groupvars = c("Condition"))
```
```{r,echo=FALSE}
# Use 95% confidence interval instead of SEM
LaneCondition <- ggplot(tgc, aes(x = Condition, y = LaneBreaks, colour = Condition)) +
    geom_errorbar(aes(ymin = LaneBreaks - ci, ymax = LaneBreaks + ci), width = .1, position = pd) +
    geom_line(position = pd) +
    geom_point(position = pd)
plot4 <- LaneCondition + scale_colour_brewer(palette = Palette)
```
```{r,echo=FALSE}
tgc <- summarySE(dataFrame, measurevar = "TotalGlances", groupvars = c("Condition"))
```
```{r,echo=FALSE}
# Use 95% confidence interval instead of SEM
GlancesCondition <- ggplot(tgc, aes(x = Condition, y = TotalGlances, colour = Condition)) +
    geom_errorbar(aes(ymin = TotalGlances - ci, ymax = TotalGlances + ci), width = .1, position = pd) +
    geom_line(position = pd) +
    geom_point(position = pd)
plot5 <- GlancesCondition + scale_colour_brewer(palette = Palette)
```
```{r,echo=FALSE}
tgc <- summarySE(dataFrame, measurevar = "TotalGlanceTime", groupvars = c("Condition"))
```
```{r,echo=FALSE}
# Use 95% confidence interval instead of SEM
GlanceTimeCondition <- ggplot(tgc, aes(x = Condition, y = TotalGlanceTime, colour = Condition)) +
    geom_errorbar(aes(ymin = TotalGlanceTime - ci, ymax = TotalGlanceTime + ci), width = .1, position = pd) +
    geom_line(position = pd) +
    geom_point(position = pd)
plot6 <- GlanceTimeCondition + scale_colour_brewer(palette = Palette)
```

```{r}
plot1 <- plot1 + theme(legend.position = "none")
plot2 <- plot2 + theme(legend.position = "none")
plot3 <- plot3 + theme(legend.position = "none")
plot4 <- plot4 + theme(legend.position = "none")
plot5 <- plot5 + theme(legend.position = "none")
plot6 <- plot6 + theme(legend.position = "none")
```

```{r,include=FALSE}
width <- 5
height <- 6
dpi <- 150
units <- "in"
Metric <- "MetricsCondition"
dir.create(Metric)

ggsave(filename = "SUSCondition.pdf", plot = plot1, path = Metric, width = width, height = height, dpi = dpi, units = units)
ggsave(filename = "SARTCondition.pdf", plot = plot2, path = Metric, width = width, height = height, dpi = dpi, units = units)
ggsave(filename = "CrashCondition.pdf", plot = plot3, path = Metric, width = width, height = height, dpi = dpi, units = units)
ggsave(filename = "LaneBreaksCondition.pdf", plot = plot4, path = Metric, width = width, height = height, dpi = dpi, units = units)
ggsave(filename = "GlancesCondition.pdf", plot = plot5, path = Metric, width = width, height = height, dpi = dpi, units = units)
ggsave(filename = "GlanceTimeCondition.pdf", plot = plot6, path = Metric, width = width, height = height, dpi = dpi, units = units)
```

### Distribution of metrics (Bar and density)
- SUS  
- SART  
- Total Crash  
- Lane Breaks  
- Total Glances  
- Total Glance Time  

#### Bar Charts
```{r}
SUSTotal <- ggplot(data = dataFrame, mapping = aes(x = SUS, fill = Condition))
SUSTotal <- SUSTotal + geom_bar(col = "black", size = .3) + scale_y_continuous(name = "Count", breaks = c(0:150)) + ggtitle("SUSTotal distribution") + scale_fill_brewer(palette = Palette)

SARTTotal <- ggplot(data = dataFrame, mapping = aes(x = SART, fill = Condition))
SARTTotal <- SARTTotal + geom_bar(col = "black", size = .3) + scale_y_continuous(name = "Count", breaks = c(0:150)) + ggtitle("SARTTotal distribution") + scale_fill_brewer(palette = Palette)

TotalCrashTotal <- ggplot(data = dataFrame, mapping = aes(x = TotalCrash, fill = Condition))
TotalCrashTotal <- TotalCrashTotal + geom_bar(col = "black", size = .3) + scale_y_continuous(name = "Count", breaks = c(0:150)) + ggtitle("TotalCrashTotal distribution") + scale_fill_brewer(palette = Palette)

LaneBreakTotal <- ggplot(data = dataFrame, mapping = aes(x = LaneBreaks, fill = Condition))
LaneBreakTotal <- LaneBreakTotal + geom_bar(col = "black", size = .3) + scale_y_continuous(name = "Count", breaks = c(0:150)) + ggtitle("LaneBreakTotal distribution") + scale_fill_brewer(palette = Palette)

GlancesTotal <- ggplot(data = dataFrame, mapping = aes(x = TotalGlances, fill = Condition))
GlancesTotal <- GlancesTotal + geom_bar(col = "black", size = .3) + scale_y_continuous(name = "Count", breaks = c(0:150)) + ggtitle("GlancesTotal distribution") + scale_fill_brewer(palette = Palette)

GlanceTimeTotal <- ggplot(data = dataFrame, mapping = aes(x = TotalGlanceTime, fill = Condition))
GlanceTimeTotal <- GlanceTimeTotal + geom_bar(col = "black", size = .3) + scale_y_continuous(name = "Count", breaks = c(0:150)) + ggtitle("SUGlanceTimeTotalSTotal distribution") + scale_fill_brewer(palette = Palette)

SUSTotal
SARTTotal
TotalCrashTotal
LaneBreakTotal
GlancesTotal
GlanceTimeTotal
```

#### Density
```{r}
alpha <- 0.4
SUSTotal <- ggplot(data = dataFrame, mapping = aes(x = SUS, fill = Condition, alpha = alpha))
SUSTotal <- SUSTotal + geom_density() + ggtitle("SUSTotal distribution") + scale_fill_brewer(palette = Palette)

SARTTotal <- ggplot(data = dataFrame, mapping = aes(x = SART, fill = Condition, alpha = alpha))
SARTTotal <- SARTTotal + geom_density() + ggtitle("SARTTotal distribution") + scale_fill_brewer(palette = Palette)

TotalCrashTotal <- ggplot(data = dataFrame, mapping = aes(x = TotalCrash, fill = Condition, alpha = alpha))
TotalCrashTotal <- TotalCrashTotal + geom_density() + ggtitle("TotalCrashTotal distribution") + scale_fill_brewer(palette = Palette)

LaneBreakTotal <- ggplot(data = dataFrame, mapping = aes(x = LaneBreaks, fill = Condition, alpha = alpha))
LaneBreakTotal <- LaneBreakTotal + geom_density() + ggtitle("LaneBreakTotal distribution") + scale_fill_brewer(palette = Palette)

GlancesTotal <- ggplot(data = dataFrame, mapping = aes(x = TotalGlances, fill = Condition, alpha = alpha))
GlancesTotal <- GlancesTotal + geom_density() + ggtitle("GlancesTotal distribution") + scale_fill_brewer(palette = Palette)

GlanceTimeTotal <- ggplot(data = dataFrame, mapping = aes(x = TotalGlanceTime, fill = Condition, alpha = alpha))
GlanceTimeTotal <- GlanceTimeTotal + geom_density() + ggtitle("SUGlanceTimeTotalSTotal distribution") + scale_fill_brewer(palette = Palette)

# SUSTotal
# SARTTotal
# TotalCrashTotal
# LaneBreakTotal
# GlancesTotal
# GlanceTimeTotal

ggplot(dataFrame, aes(x = TotalGlances, y = TotalGlanceTime, color = Condition)) +
    geom_point(size = 2, shape = 23) +
    geom_smooth(method = lm, se = FALSE)
```

<!-- ### Sammenhæng SART og SUS -->
```{r,echo=FALSE}
# SARTSUS <- lm(SUS ~ SART, data = dataFrame)
# summary(SARTSUS)
# ggplot(dataFrame,aes(SART, SUS,color=Condition)) + geom_point() + geom_smooth(method='lm',se=FALSE)
```

## Statistical analysis
Statistics will be run on all driving performance metrics grouped by conditions, to look for significant main effects.
The normality and the variance will be analysed to ensure the correct statistical test is being used.
Sharpiro Wilk test will be used to analyse the distribution of the residuals.
Bartlett's test will be used in case of normality to analyse the variance
Levenes test will be used in case the residuals are not normal distributed to analyse the variance

### Analysis of Glance Time grouped by conditions
The residuals proved to be normally distributed and the data has homogene variance which means a standard ANOVA test can be used
```{r, include=FALSE}
library(ggpubr)
# library(tidyverse)
# library(broom)
```

```{r}
glanceTimeData <- subset(dataFrame, select = c("Participants", "Condition", "TotalGlanceTime"))
summary(glanceTimeData)
get_summary_stats(glanceTimeData)

glanceTimeData %>%
    group_by(Condition) %>%
    identify_outliers(TotalGlanceTime)

glanceTimeModel <- lm(TotalGlanceTime ~ Condition, data = glanceTimeData)
ggqqplot(residuals(glanceTimeModel))
shapiro_test(residuals(glanceTimeModel))

# We use a bartlett test as the residuals are normally distributed
bartlett.test(TotalGlanceTime ~ Condition, data = glanceTimeData)

glanceTimeTest <- glanceTimeData %>% anova_test(TotalGlanceTime ~ Condition)
glanceTimeTest
```

### Analysis of Glance Count grouped by conditions
```{r}
glanceCountData <- subset(dataFrame, select = c("Participants", "Condition", "TotalGlances"))
summary(glanceCountData)
get_summary_stats(glanceCountData)

glanceCountData %>%
    group_by(Condition) %>%
    identify_outliers(TotalGlances)

glanceCountModel <- lm(TotalGlances ~ Condition, data = glanceCountData)
ggqqplot(residuals(glanceCountModel))
shapiro_test(residuals(glanceCountModel))

bartlett.test(TotalGlances ~ Condition, data = glanceCountData)

glanceCountTest <- glanceCountData %>% welch_anova_test(TotalGlances ~ Condition)
glanceCountTest
```

### Analysis of Crash Count grouped by condition
```{r}
crashData <- subset(dataFrame, select = c("Participants", "Condition", "TotalCrash"))
summary(crashData)
get_summary_stats(crashData)

crashData %>%
    group_by(Condition) %>%
    identify_outliers(TotalCrash)

crashDataModel <- lm(TotalCrash ~ Condition, data = crashData)
ggqqplot(residuals(crashDataModel))
shapiro_test(residuals(crashDataModel))

crashData %>% levene_test(TotalCrash ~ Condition)

crashDataTest <- crashData %>% kruskal_test(TotalCrash ~ Condition)
crashDataTest
```

#### Crash Count visualization
Another way to present the crash data would be to score crashes pr condition:
```{r,echo=FALSE}
TotalCrash <- ggplot(data = dataFrame, mapping = aes(x = Condition, y = TotalCrash, fill = Condition))
TotalCrash <- TotalCrash + geom_col(col = "black") + scale_y_continuous(name = "Crash count", breaks = c(0:15)) + ggtitle("Total Crash ") #+ scale_x_binned()

Palette <- "Set1"
TotalCrash + scale_fill_brewer(palette = Palette)
```
It can be seen on this graph that each condition has about the same total crashes and some conditions have one or two participants responsible for extra crashes.  

### Analysis of Lane Breaks grouped by condition
```{r}
laneData <- subset(dataFrame, select = c("Participants", "Condition", "LaneBreaks"))
summary(laneData)
get_summary_stats(laneData)

laneData %>%
    group_by(Condition) %>%
    identify_outliers(LaneBreaks)

laneDataModel <- lm(LaneBreaks ~ Condition, data = laneData)
ggqqplot(residuals(laneDataModel))
shapiro_test(residuals(laneDataModel))

laneData %>% levene_test(LaneBreaks ~ Condition)

laneDataTest <- laneData %>% kruskal_test(LaneBreaks ~ Condition)
laneDataTest
```

### Analysis of SUS grouped by condition
```{r}
susData <- subset(dataFrame, select = c("Participants", "Condition", "SUS"))
summary(susData)
get_summary_stats(susData)

susData %>%
    group_by(Condition) %>%
    identify_outliers(SUS)

susDataModel <- lm(SUS ~ Condition, data = susData)
ggqqplot(residuals(susDataModel))
shapiro_test(residuals(susDataModel))

susData %>% levene_test(SUS ~ Condition)

susDataTest <- susData %>% kruskal_test(SUS ~ Condition)
susDataTest
```

### Analysis of SART grouped by condition
```{r}
sartData <- subset(dataFrame, select = c("Participants", "Condition", "SART"))
sartData <- sartData[!(sartData$Participants == "P12" | sartData$Participants == "P13" | sartData$Participants == "P29" | sartData$Participants == "P30"), ]
summary(sartData)
get_summary_stats(sartData)

sartData %>%
    group_by(Condition) %>%
    identify_outliers(SART)

sartDataModel <- lm(SART ~ Condition, data = sartData)
ggqqplot(residuals(sartDataModel))
shapiro_test(residuals(sartDataModel))

bartlett.test(SART ~ Condition, data = sartData)

sartDataTest <- sartData %>% anova_test(SART ~ Condition)
sartDataTest
```

```{r, include=FALSE}
detach("package:ggpubr")
# detach("package:tidyverse")
# detach("package:broom")
```

### Analysis of use of aid grouped by condition
```{r}
aidData <- subset(dataFrame, select = c("Participants", "Condition", "UseOfAid"))
aidData <- aidData[!(aidData$Condition == "Touch_only"), ]
summary(aidData)
get_summary_stats(aidData)

aidPlotData <- subset(aidData, UseOfAid > 0)
aidPlot <- ggplot(data = aidPlotData, mapping = aes(x = Condition, y = UseOfAid, fill = Condition, label = UseOfAid))
aidPlot + geom_col(col = "black") +
    scale_y_continuous(name = "UseOfAid", breaks = c(0:15)) + ggtitle("Use of aid ") +
    geom_text(size = 6, position = position_stack(vjust = 0.5))
```
<!-- It is seen that the SART does not influence the SUS in a significant way. -->

## Plot of means - All Dependent variables vs All Independent variables
To investigate weather differences in demographics have had an influence on conditions a plot of means for each metric will be performed with each independent variable. This will be done with wiskers as 95% confidence interval and if the data has homoscedasticity it could be possible to eyeball significant influences. If these are detected we'll perform a t-test 

Dependent variables:  
- SUS  
- SART  
- Total Crash  
- Lane Breaks  
- Total Glances  
- Total Glance Time  
  
Independent variables:  
- Condition  
- Gender  
- Gaming  
- Drivers licence  (This plot will have a linear model underneath it (x=Years with drivers license y=Dependent variable))
- Automatic gear  
- Car Simulator

### SUS
```{r,echo=FALSE}
tgc <- summarySE(dataFrame, measurevar = "SUS", groupvars = c("Condition"))
```
```{r,echo=FALSE}
# Use 95% confidence interval instead of SEM
plot1 <- ggplot(tgc, aes(x = Condition, y = SUS, colour = Condition)) +
    geom_errorbar(aes(ymin = SUS - ci, ymax = SUS + ci), width = .1, position = pd) +
    geom_line(position = pd) +
    geom_point(position = pd)
```

```{r,echo=FALSE}
tgc <- summarySE(dataFrame, measurevar = "SUS", groupvars = c("Gender"))
```
```{r ,echo=FALSE}
# Use 95% confidence interval instead of SEM
plot2 <- ggplot(tgc, aes(x = Gender, y = SUS, colour = Gender)) +
    geom_errorbar(aes(ymin = SUS - ci, ymax = SUS + ci), width = .1, position = pd) +
    geom_line(position = pd) +
    geom_point(position = pd)
```

```{r,echo=FALSE}
tgc <- summarySE(dataFrame, measurevar = "SUS", groupvars = c("ComputerGames"))
```
```{r,echo=FALSE}
# Use 95% confidence interval instead of SEM
plot3 <- ggplot(tgc, aes(x = ComputerGames, y = SUS, colour = ComputerGames)) +
    geom_errorbar(aes(ymin = SUS - ci, ymax = SUS + ci), width = .1, position = pd) +
    geom_line(position = pd) +
    geom_point(position = pd)
```

```{r,echo=FALSE}
tgc <- summarySE(dataFrame, measurevar = "SUS", groupvars = c("YearDriversLicence"))
```
```{r,echo=FALSE}
# Use 95% confidence interval instead of SEM
plot4 <- ggplot(tgc, aes(x = YearDriversLicence, y = SUS, colour = YearDriversLicence)) +
    geom_errorbar(aes(ymin = SUS - ci, ymax = SUS + ci), width = .1, position = pd) +
    geom_line(position = pd) +
    geom_point(position = pd)


x <- dataFrame$YearDriversLicence
y <- dataFrame$SUS

model <- lm(y ~ x, data = dataFrame)
plot4 <- ggplot(dataFrame, aes(x, y, color = Condition)) +
    geom_point() +
    geom_smooth(method = "lm", se = FALSE)
plot4
```

```{r,echo=FALSE}
tgc <- summarySE(dataFrame, measurevar = "SUS", groupvars = c("SimulatorExperience"))
```
```{r,echo=FALSE}
# Use 95% confidence interval instead of SEM
plot5 <- ggplot(tgc, aes(x = SimulatorExperience, y = SUS, colour = SimulatorExperience)) +
    geom_errorbar(aes(ymin = SUS - ci, ymax = SUS + ci), width = .1, position = pd) +
    geom_line(position = pd) +
    geom_point(position = pd)
```

```{r,echo=FALSE}
tgc <- summarySE(dataFrame, measurevar = "SUS", groupvars = c("Automatic"))
```
```{r,echo=FALSE}
# Use 95% confidence interval instead of SEM
plot6 <- ggplot(tgc, aes(x = Automatic, y = SUS, colour = Automatic)) +
    geom_errorbar(aes(ymin = SUS - ci, ymax = SUS + ci), width = .1, position = pd) +
    geom_line(position = pd) +
    geom_point(position = pd)
```

```{r}
SaveSixPlots(Metric = "SUS")
```


### Sart
```{r,echo=FALSE}
tgc <- summarySE(dataFrame, measurevar = "SART", groupvars = c("Condition"))
```
```{r,echo=FALSE}
# Use 95% confidence interval instead of SEM
plot1 <- ggplot(tgc, aes(x = Condition, y = SART, colour = Condition)) +
    geom_errorbar(aes(ymin = SART - ci, ymax = SART + ci), width = .1, position = pd) +
    geom_line(position = pd) +
    geom_point(position = pd)
```

```{r,echo=FALSE}
tgc <- summarySE(dataFrame, measurevar = "SART", groupvars = c("Gender"))
```
```{r,echo=FALSE}
# Use 95% confidence interval instead of SEM
plot2 <- ggplot(tgc, aes(x = Gender, y = SART, colour = Gender)) +
    geom_errorbar(aes(ymin = SART - ci, ymax = SART + ci), width = .1, position = pd) +
    geom_line(position = pd) +
    geom_point(position = pd)
```

```{r,echo=FALSE}
tgc <- summarySE(dataFrame, measurevar = "SART", groupvars = c("ComputerGames"))
```
```{r,echo=FALSE}
# Use 95% confidence interval instead of SEM
plot3 <- ggplot(tgc, aes(x = ComputerGames, y = SART, colour = ComputerGames)) +
    geom_errorbar(aes(ymin = SART - ci, ymax = SART + ci), width = .1, position = pd) +
    geom_line(position = pd) +
    geom_point(position = pd)
```

```{r,echo=FALSE}
tgc <- summarySE(dataFrame, measurevar = "SART", groupvars = c("YearDriversLicence"))
```
```{r,echo=FALSE}
# Use 95% confidence interval instead of SEM
plot4 <- ggplot(tgc, aes(x = YearDriversLicence, y = SART, colour = YearDriversLicence)) +
    geom_errorbar(aes(ymin = SART - ci, ymax = SART + ci), width = .1, position = pd) +
    geom_line(position = pd) +
    geom_point(position = pd)

x <- dataFrame$YearDriversLicence
y <- dataFrame$SART
model <- lm(y ~ x, data = dataFrame)
plot4 <- ggplot(dataFrame, aes(x, y, color = Condition)) +
    geom_point() +
    geom_smooth(method = "lm", se = FALSE)
# plot4
```

```{r,echo=FALSE}
tgc <- summarySE(dataFrame, measurevar = "SART", groupvars = c("SimulatorExperience"))
```
```{r,echo=FALSE}
# Use 95% confidence interval instead of SEM
plot5 <- ggplot(tgc, aes(x = SimulatorExperience, y = SART, colour = SimulatorExperience)) +
    geom_errorbar(aes(ymin = SART - ci, ymax = SART + ci), width = .1, position = pd) +
    geom_line(position = pd) +
    geom_point(position = pd)
```

```{r,echo=FALSE}
tgc <- summarySE(dataFrame, measurevar = "SART", groupvars = c("Automatic"))
```
```{r,echo=FALSE}
# Use 95% confidence interval instead of SEM
plot6 <- ggplot(tgc, aes(x = Automatic, y = SART, colour = Automatic)) +
    geom_errorbar(aes(ymin = SART - ci, ymax = SART + ci), width = .1, position = pd) +
    geom_line(position = pd) +
    geom_point(position = pd)
```
```{r}
SaveSixPlots("SART")
```
### Total crash
```{r,echo=FALSE}
tgc <- summarySE(dataFrame, measurevar = "TotalCrash", groupvars = c("Condition"))
```
```{r,echo=FALSE}
# Use 95% confidence interval instead of SEM
plot1 <- ggplot(tgc, aes(x = Condition, y = TotalCrash, colour = Condition)) +
    geom_errorbar(aes(ymin = TotalCrash - ci, ymax = TotalCrash + ci), width = .1, position = pd) +
    geom_line(position = pd) +
    geom_point(position = pd)
```

```{r,echo=FALSE}
tgc <- summarySE(dataFrame, measurevar = "TotalCrash", groupvars = c("Gender"))
```
```{r,echo=FALSE}
# Use 95% confidence interval instead of SEM
plot2 <- ggplot(tgc, aes(x = Gender, y = TotalCrash, colour = Gender)) +
    geom_errorbar(aes(ymin = TotalCrash - ci, ymax = TotalCrash + ci), width = .1, position = pd) +
    geom_line(position = pd) +
    geom_point(position = pd)
```

```{r,echo=FALSE}
tgc <- summarySE(dataFrame, measurevar = "TotalCrash", groupvars = c("ComputerGames"))
```
```{r,echo=FALSE}
# Use 95% confidence interval instead of SEM
plot3 <- ggplot(tgc, aes(x = ComputerGames, y = TotalCrash, colour = ComputerGames)) +
    geom_errorbar(aes(ymin = TotalCrash - ci, ymax = TotalCrash + ci), width = .1, position = pd) +
    geom_line(position = pd) +
    geom_point(position = pd)
```

```{r,echo=FALSE}
tgc <- summarySE(dataFrame, measurevar = "TotalCrash", groupvars = c("YearDriversLicence"))
```
```{r,echo=FALSE}
# Use 95% confidence interval instead of SEM
plot4 <- ggplot(tgc, aes(x = YearDriversLicence, y = TotalCrash, colour = YearDriversLicence)) +
    geom_errorbar(aes(ymin = TotalCrash - ci, ymax = TotalCrash + ci), width = .1, position = pd) +
    geom_line(position = pd) +
    geom_point(position = pd)

x <- dataFrame$YearDriversLicence
y <- dataFrame$TotalCrash
model <- lm(y ~ x, data = dataFrame)
plot4 <- ggplot(dataFrame, aes(x, y, color = Condition)) +
    geom_point() +
    geom_smooth(method = "lm", se = FALSE)
# plot4
```

```{r,echo=FALSE}
tgc <- summarySE(dataFrame, measurevar = "TotalCrash", groupvars = c("SimulatorExperience"))
```
```{r,echo=FALSE}
# Use 95% confidence interval instead of SEM
plot5 <- ggplot(tgc, aes(x = SimulatorExperience, y = TotalCrash, colour = SimulatorExperience)) +
    geom_errorbar(aes(ymin = TotalCrash - ci, ymax = TotalCrash + ci), width = .1, position = pd) +
    geom_line(position = pd) +
    geom_point(position = pd)
```

```{r,echo=FALSE}
tgc <- summarySE(dataFrame, measurevar = "TotalCrash", groupvars = c("Automatic"))
```
```{r,echo=FALSE}
# Use 95% confidence interval instead of SEM
plot6 <- ggplot(tgc, aes(x = Automatic, y = TotalCrash, colour = Automatic)) +
    geom_errorbar(aes(ymin = TotalCrash - ci, ymax = TotalCrash + ci), width = .1, position = pd) +
    geom_line(position = pd) +
    geom_point(position = pd)
```
```{r}
SaveSixPlots("TotalCrash")
```

### Lane Breaks
```{r,echo=FALSE}
tgc <- summarySE(dataFrame, measurevar = "LaneBreaks", groupvars = c("Condition"))
```
```{r,echo=FALSE}
# Use 95% confidence interval instead of SEM
plot1 <- ggplot(tgc, aes(x = Condition, y = LaneBreaks, colour = Condition)) +
    geom_errorbar(aes(ymin = LaneBreaks - ci, ymax = LaneBreaks + ci), width = .1, position = pd) +
    geom_line(position = pd) +
    geom_point(position = pd)
```

```{r,echo=FALSE}
tgc <- summarySE(dataFrame, measurevar = "LaneBreaks", groupvars = c("Gender"))
```
```{r,echo=FALSE}
# Use 95% confidence interval instead of SEM
plot2 <- ggplot(tgc, aes(x = Gender, y = LaneBreaks, colour = Gender)) +
    geom_errorbar(aes(ymin = LaneBreaks - ci, ymax = LaneBreaks + ci), width = .1, position = pd) +
    geom_line(position = pd) +
    geom_point(position = pd)
```

```{r,echo=FALSE}
tgc <- summarySE(dataFrame, measurevar = "LaneBreaks", groupvars = c("ComputerGames"))
```
```{r,echo=FALSE}
# Use 95% confidence interval instead of SEM
plot3 <- ggplot(tgc, aes(x = ComputerGames, y = LaneBreaks, colour = ComputerGames)) +
    geom_errorbar(aes(ymin = LaneBreaks - ci, ymax = LaneBreaks + ci), width = .1, position = pd) +
    geom_line(position = pd) +
    geom_point(position = pd)
```

```{r,echo=FALSE}
tgc <- summarySE(dataFrame, measurevar = "LaneBreaks", groupvars = c("YearDriversLicence"))
```
```{r,echo=FALSE}
# Use 95% confidence interval instead of SEM
plot4 <- ggplot(tgc, aes(x = YearDriversLicence, y = LaneBreaks, colour = YearDriversLicence)) +
    geom_errorbar(aes(ymin = LaneBreaks - ci, ymax = LaneBreaks + ci), width = .1, position = pd) +
    geom_line(position = pd) +
    geom_point(position = pd)

x <- dataFrame$YearDriversLicence
y <- dataFrame$LaneBreaks
model <- lm(y ~ x, data = dataFrame)
plot4 <- ggplot(dataFrame, aes(x, y, color = Condition)) +
    geom_point() +
    geom_smooth(method = "lm", se = FALSE)
# plot4
```

```{r,echo=FALSE}
tgc <- summarySE(dataFrame, measurevar = "LaneBreaks", groupvars = c("SimulatorExperience"))
```
```{r,echo=FALSE}
# Use 95% confidence interval instead of SEM
plot5 <- ggplot(tgc, aes(x = SimulatorExperience, y = LaneBreaks, colour = SimulatorExperience)) +
    geom_errorbar(aes(ymin = LaneBreaks - ci, ymax = LaneBreaks + ci), width = .1, position = pd) +
    geom_line(position = pd) +
    geom_point(position = pd)
```

```{r,echo=FALSE}
tgc <- summarySE(dataFrame, measurevar = "LaneBreaks", groupvars = c("Automatic"))
```
```{r,echo=FALSE}
# Use 95% confidence interval instead of SEM
plot6 <- ggplot(tgc, aes(x = Automatic, y = LaneBreaks, colour = Automatic)) +
    geom_errorbar(aes(ymin = LaneBreaks - ci, ymax = LaneBreaks + ci), width = .1, position = pd) +
    geom_line(position = pd) +
    geom_point(position = pd)
```
```{r}
SaveSixPlots("LaneBreaks")
```

### Total Glances
```{r,echo=FALSE}
tgc <- summarySE(dataFrame, measurevar = "TotalGlances", groupvars = c("Condition"))
```
```{r,echo=FALSE}
# Use 95% confidence interval instead of SEM
plot1 <- ggplot(tgc, aes(x = Condition, y = TotalGlances, colour = Condition)) +
    geom_errorbar(aes(ymin = TotalGlances - ci, ymax = TotalGlances + ci), width = .1, position = pd) +
    geom_line(position = pd) +
    geom_point(position = pd)
```

```{r,echo=FALSE}
tgc <- summarySE(dataFrame, measurevar = "TotalGlances", groupvars = c("Gender"))
```
```{r,echo=FALSE}
# Use 95% confidence interval instead of SEM
plot2 <- ggplot(tgc, aes(x = Gender, y = TotalGlances, colour = Gender)) +
    geom_errorbar(aes(ymin = TotalGlances - ci, ymax = TotalGlances + ci), width = .1, position = pd) +
    geom_line(position = pd) +
    geom_point(position = pd)
```

```{r,echo=FALSE}
tgc <- summarySE(dataFrame, measurevar = "TotalGlances", groupvars = c("ComputerGames"))
```
```{r,echo=FALSE}
# Use 95% confidence interval instead of SEM
plot3 <- ggplot(tgc, aes(x = ComputerGames, y = TotalGlances, colour = ComputerGames)) +
    geom_errorbar(aes(ymin = TotalGlances - ci, ymax = TotalGlances + ci), width = .1, position = pd) +
    geom_line(position = pd) +
    geom_point(position = pd)
```

```{r,echo=FALSE}
tgc <- summarySE(dataFrame, measurevar = "TotalGlances", groupvars = c("YearDriversLicence"))
```
```{r,echo=FALSE}
# Use 95% confidence interval instead of SEM
plot4 <- ggplot(tgc, aes(x = YearDriversLicence, y = TotalGlances, colour = YearDriversLicence)) +
    geom_errorbar(aes(ymin = TotalGlances - ci, ymax = TotalGlances + ci), width = .1, position = pd) +
    geom_line(position = pd) +
    geom_point(position = pd)


x <- dataFrame$YearDriversLicence
y <- dataFrame$TotalGlances
model <- lm(y ~ x, data = dataFrame)
plot4 <- ggplot(dataFrame, aes(x, y, color = Condition)) +
    geom_point() +
    geom_smooth(method = "lm", se = FALSE)
# plot4
```

```{r,echo=FALSE}
tgc <- summarySE(dataFrame, measurevar = "TotalGlances", groupvars = c("SimulatorExperience"))
```
```{r,echo=FALSE}
# Use 95% confidence interval instead of SEM
plot5 <- ggplot(tgc, aes(x = SimulatorExperience, y = TotalGlances, colour = SimulatorExperience)) +
    geom_errorbar(aes(ymin = TotalGlances - ci, ymax = TotalGlances + ci), width = .1, position = pd) +
    geom_line(position = pd) +
    geom_point(position = pd)
```

```{r,echo=FALSE}
tgc <- summarySE(dataFrame, measurevar = "TotalGlances", groupvars = c("Automatic"))
```
```{r,echo=FALSE}
# Use 95% confidence interval instead of SEM
plot6 <- ggplot(tgc, aes(x = Automatic, y = TotalGlances, colour = Automatic)) +
    geom_errorbar(aes(ymin = TotalGlances - ci, ymax = TotalGlances + ci), width = .1, position = pd) +
    geom_line(position = pd) +
    geom_point(position = pd)
```

```{r}
SaveSixPlots("TotalGlances")
```
### Total Glance time 
```{r,echo=FALSE}
tgc <- summarySE(dataFrame, measurevar = "TotalGlanceTime", groupvars = c("Condition"))
```
```{r,echo=FALSE}
# Use 95% confidence interval instead of SEM
plot1 <- ggplot(tgc, aes(x = Condition, y = TotalGlanceTime, colour = Condition)) +
    geom_errorbar(aes(ymin = TotalGlanceTime - ci, ymax = TotalGlanceTime + ci), width = .1, position = pd) +
    geom_line(position = pd) +
    geom_point(position = pd)
```

```{r,echo=FALSE}
tgc <- summarySE(dataFrame, measurevar = "TotalGlanceTime", groupvars = c("Gender"))
```
```{r,echo=FALSE}
# Use 95% confidence interval instead of SEM
plot2 <- ggplot(tgc, aes(x = Gender, y = TotalGlanceTime, colour = Gender)) +
    geom_errorbar(aes(ymin = TotalGlanceTime - ci, ymax = TotalGlanceTime + ci), width = .1, position = pd) +
    geom_line(position = pd) +
    geom_point(position = pd)
```

```{r,echo=FALSE}
tgc <- summarySE(dataFrame, measurevar = "TotalGlanceTime", groupvars = c("ComputerGames"))
```
```{r,echo=FALSE}
# Use 95% confidence interval instead of SEM
plot3 <- ggplot(tgc, aes(x = ComputerGames, y = TotalGlanceTime, colour = ComputerGames)) +
    geom_errorbar(aes(ymin = TotalGlanceTime - ci, ymax = TotalGlanceTime + ci), width = .1, position = pd) +
    geom_line(position = pd) +
    geom_point(position = pd)
```

```{r,echo=FALSE}
tgc <- summarySE(dataFrame, measurevar = "TotalGlanceTime", groupvars = c("YearDriversLicence"))
```
```{r,echo=FALSE}
# Use 95% confidence interval instead of SEM
plot4 <- ggplot(tgc, aes(x = YearDriversLicence, y = TotalGlanceTime, colour = YearDriversLicence)) +
    geom_errorbar(aes(ymin = TotalGlanceTime - ci, ymax = TotalGlanceTime + ci), width = .1, position = pd) +
    geom_line(position = pd) +
    geom_point(position = pd)

x <- dataFrame$YearDriversLicence
y <- dataFrame$TotalGlanceTime
model <- lm(y ~ x, data = dataFrame)
plot4 <- ggplot(dataFrame, aes(x, y, color = Condition)) +
    geom_point() +
    geom_smooth(method = "lm", se = FALSE)
# plot4
```

```{r,echo=FALSE}
tgc <- summarySE(dataFrame, measurevar = "TotalGlanceTime", groupvars = c("SimulatorExperience"))
```
```{r,echo=FALSE}
# Use 95% confidence interval instead of SEM
plot5 <- ggplot(tgc, aes(x = SimulatorExperience, y = TotalGlanceTime, colour = SimulatorExperience)) +
    geom_errorbar(aes(ymin = TotalGlanceTime - ci, ymax = TotalGlanceTime + ci), width = .1, position = pd) +
    geom_line(position = pd) +
    geom_point(position = pd)
```

```{r,echo=FALSE}
tgc <- summarySE(dataFrame, measurevar = "TotalGlanceTime", groupvars = c("Automatic"))
```
```{r,echo=FALSE}
# Use 95% confidence interval instead of SEM
plot6 <- ggplot(tgc, aes(x = Automatic, y = TotalGlanceTime, colour = Automatic)) +
    geom_errorbar(aes(ymin = TotalGlanceTime - ci, ymax = TotalGlanceTime + ci), width = .1, position = pd) +
    geom_line(position = pd) +
    geom_point(position = pd)
```

```{r,echo=FALSE}
SaveSixPlots("TotalGlanceTime")
```

<!-- ## Boxplots -->

```{r,echo=FALSE}
# library(ggplot2)
# SusCondition=ggplot(data=dataFrame, mapping=aes(x=Condition, y=SUS,fill = Condition))+geom_boxplot()
# SartCondition=ggplot(data=dataFrame, mapping=aes(x=Condition, y=SART,fill = Condition))+geom_boxplot()
# SusGender=ggplot(data=dataFrame, mapping=aes(x=Gender, y=SUS,fill = Gender))+geom_boxplot()
# SartGender=ggplot(data=dataFrame, mapping=aes(x=Gender, y=SART,fill = Gender))+geom_boxplot()
# SusComputerGames=ggplot(data=dataFrame, mapping=aes(x=ComputerGames, y=SUS,fill = ComputerGames))+geom_boxplot()
# SartComputerGames=ggplot(data=dataFrame, mapping=aes(x=ComputerGames, y=SART,fill = ComputerGames))+geom_boxplot()
#
# SusCondition
# SartCondition
# SusGender
# SartGender
# SusComputerGames
# SartComputerGames
```



## From the many plot of means with confidence interval 95% as wisksers we've determined to test the following interactions

```{r}
LaneBreaksAutomatic <- t.test(formula = LaneBreaks ~ Automatic, data = dataFrame)
SartGender <- t.test(formula = SART ~ Gender, data = dataFrame)
CrashComputer <- kruskal.test(formula = TotalCrash ~ ComputerGames, data = dataFrame)
CrashAutomatic <- t.test(formula = TotalCrash ~ Automatic, data = dataFrame)
GlanceTimeAutomatic <- t.test(formula = TotalGlanceTime ~ Automatic, data = dataFrame)
GlancesGender <- t.test(formula = TotalGlances ~ Gender, data = dataFrame)
GlancesAutomatic <- t.test(formula = TotalGlances ~ Automatic, data = dataFrame)

# Måske er der noget med glances og condition

LaneBreaksAutomatic
SartGender
CrashComputer
CrashAutomatic
GlanceTimeAutomatic
GlancesGender
GlancesAutomatic
```

When analysing this much data the risk of p-hacking increases. We'll only use these significanses if there is a big heteroscedasticity in regards to the four conditions maybe this change can explain 

The three significant effects were:  
1) LaneBreaks by Automatic 0.01666  
2) TotalGlanceTime by Automatic 0.007043  
3) SART by Gender 0.02699 

We'll see if these effects have been equally distributed across the four conditions:  
```{r}
AutomaticExperienceCondition
```
Automatic experience is distributed quite nice with a difference of 2 between highest and lowest.
Therefore this effect is irrelevant.  
```{r}
GenderCondition
```
Gender  is distributed with a difference of 1 between highest and lowest.
Therefore this effect is irrelevant


To test significance we will use ANOVA  
ANOVA has Three assumptions  
1) Normality  
2) Homogenity  
3) Independence  
The assumption of Independence is meet as our participants haven't influence each other in any way we know of. The participants were instructed not to speak with each other between trials and we can hope they have met this instruction.

### Analysis of glance duration per task
Another interesting aspect to look at is the distribution of glance duration across all tasks.
This could potentially reveal patterns in certain tasks taking longer on average, indicating an imbalance in difficulty among the tasks
```{r, echo=FALSE}
urlfile <- "https://raw.githubusercontent.com/JeppeGivskud/P6-Tactile-Navigation/main/Long_data.csv"
taskLongDataFrame <- read.csv(url(urlfile), header = TRUE, stringsAsFactors = TRUE)
taskLongDataFrame <- subset(taskLongDataFrame, Task_nr > 0)

urlfile <- "https://raw.githubusercontent.com/JeppeGivskud/P6-Tactile-Navigation/main/Short_data.csv"
taskShortDataFrame <- read.csv(url(urlfile), header = TRUE, stringsAsFactors = TRUE)
taskShortDataFrame <- subset(taskShortDataFrame, Task_nr > 0)
```

The glance durations are analysed with regards to guidelines found for IVIS designs
- a single glance should be shorter than 1.5 seconds
- the total time with eyes off the road should be less than 12 seconds for each task
```{r}
percentTooLongGlances <- (sum(taskLongDataFrame$Single_Glance_duration >= 2.1) / sum(taskLongDataFrame$Single_Glance_duration > 0)) * 100
percentTooLongGlances

percentTooLongTasks <- (sum(taskShortDataFrame$Total_glance_duration_pr_task >= 12.2) / sum(taskShortDataFrame$Total_glance_duration_pr_task > 0)) * 100
percentTooLongTasks

singleGlanceBox <- ggplot(taskLongDataFrame, aes(x = factor(Task_nr), y = Single_Glance_duration, fill = factor(Task_nr))) +
    geom_boxplot() +
    scale_fill_brewer(palette = "Spectral") +
    labs(x = "Task Nr", y = "Single glance time", fill = "Task Nr", title = "Single glance time grouped by task") +
    theme(plot.title = element_text(hjust = 0.5))
singleGlanceBox


glanceTaskBox <- ggplot(taskShortDataFrame, aes(x = Task_nr, y = Total_glance_duration_pr_task, group = Task_nr, fill = factor(Task_nr))) +
    geom_boxplot() +
    scale_x_continuous(breaks = seq(0, 10, by = 1)) +
    scale_fill_brewer(palette = "Spectral") +
    labs(x = "Task Nr", y = "Total glance time", fill = "Task Nr", title = "Total glance time grouped by task number") +
    theme(plot.title = element_text(hjust = 0.5))
glanceTaskBox
```

```{r, echo=FALSE}
dir <- "TaskAnalysis"
dir.create(dir)
ggsave(filename = "SingleGlanceBox.pdf", plot = singleGlanceBox, path = dir, width = width, height = height, dpi = dpi, units = units)
ggsave(filename = "TotalGlanceBox.pdf", plot = glanceTaskBox, path = dir, width = width, height = height, dpi = dpi, units = units)
```

```{r}
glanceTaskData <- subset(taskShortDataFrame, select = c("Subject", "Condition", "Task_nr", "Total_glance_duration_pr_task"))
glanceTaskData %>%
    group_by(Task_nr) %>%
    identify_outliers(Total_glance_duration_pr_task)

ggplot(glanceTaskData, aes(x = Task_nr, y = Total_glance_duration_pr_task)) +
    geom_point()

glanceTaskModel <- lm(Total_glance_duration_pr_task ~ factor(Task_nr), data = glanceTaskData)
ggqqplot(residuals(glanceTaskModel))
plot(glanceTaskModel)
shapiro_test(residuals(glanceTaskModel))

glanceTaskData %>% levene_test(Total_glance_duration_pr_task ~ factor(Task_nr))
```

The scatterplot shows no clear pattern within the data, so a linear fit approach is used
Density plots show little evidence of normality within the data, and shows that variance is non homogene between tasks

Evaluating the residuals from the linear regression in a qq plot shows that the residuals are not normally distributed, with too many data points falling above the predicted value
Further more plotting the linear regression in a fitted residual plot shows that the predicted value doesn't follow a linear pattern
The shapiro shows a significant result, meaning the residuals are not normally distributed

Through conducting a levene test it also shows no homoscedasticity of variance between tasks

This means all assumptions for ANOVA are broken, possibly due to too many extreme outliers in the dataset 