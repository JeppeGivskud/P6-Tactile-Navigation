---
title: "Tactile navigation"
author: "Jeppe"
date: '2023-05-01'
output: html_document
editor_options: 
  markdown: 
    wrap: 72
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)

#Imports data outside working directory
library(readxl)
filename = "~/Downloads/A - SART&SUS&DEMOGRAPHICS.xlsx" #path for macbook downloads folder
SartSusDemo <- read_excel(filename, sheet= "DataanalyseExport")

```
## Introduction
A study on driving performance and In Vehicle infotainment system has been done. The study aims two answer two questions.
1) Can the addition of tactile navigation improve driving performance
2) Which tactile navigation (if any) improves driving performance most

The first part of this statistical analysis aims to investigate the sample to answer if the data is normally distributed and if the participants's characteristics are distributed across the four conditions. If this is not the case an effect of condition could be attributed to other personal factors of the participants (e.g. gaming experience).

Independent variable: Condition (Acrylic, Bar, Combination & Touch only)

Metrics: SUS, SART, Glance Time, Total Glances, Lane Breaks, Total Crash.

Demographics: Gender, Age, Gaming experience, Driving experience, Simulator experience, Car games experience, Automatic gear expereience
## Population distribution
```{r, echo=FALSE} 
#                         !!!LÆS DETTE FOR AT FORSTÅ!!!
#Der bruges forskellige funktioner i disse plots. 
#Den første funktion ggplot vælger data og x og y akser. Eksempelevis x=condition og så fylder den farve på efter gender.
#Geom bar gør at plottet er et barplot med en stregtykkelse 
#Scale_y_continuous gør at man kan ændre y aksen med label og hakker
#scale_y_discrete gør man kan ændre y aksen med label og labels (for konditioner)
#scale_x_binned deler yeardriverslicence op i 16 grupper
#scale_fill_discrete gør man kan ændre labels på legend med titel og konditioner
#ggtitle ændrer titel
#Siden titlerne er ændret skal man lige fjerne dem og se om der er byttet rundt på konditioner. Man kan nemlig godt kalde bar for acrylic og så bliver vi forvirret
```

```{r} 
GenderCondition <- ggplot(data=SartSusDemo, mapping=aes(x=Condition,fill = Gender))
GenderCondition <- GenderCondition + geom_bar(col="black", size=.3)+ scale_y_continuous(name = "Count",breaks=c(0:15)) + ggtitle("Gender distribution")

AgeCondition <- ggplot(data=SartSusDemo, mapping=aes(x=Age,fill = Condition))
AgeCondition <- AgeCondition + geom_bar(col="black", size=.3) + scale_y_continuous(name = "Count",breaks=c(0:15))+scale_x_continuous(breaks = c(20:34)) + scale_fill_discrete(name = "Condition", labels = c("Acrylic", "Bar", "Combination","Touch only")) + ggtitle("Age distribution")

ComputerCondition <- ggplot(data=SartSusDemo, mapping=aes(x=Condition,fill = ComputerGames))
ComputerCondition <- ComputerCondition + geom_bar(col="black", size=.3) + scale_y_continuous(name = "Count",breaks=c(0:15)) + scale_x_discrete(labels=c("Acrylic","Bar","Combination","Touch only"))+scale_fill_discrete(name = "Computer gaming (Hours)") + ggtitle("Gaming experience distribution")

DrivingCondition <- ggplot(data=SartSusDemo, mapping=aes(x=YearDriversLicence,fill = Condition))
DrivingCondition <- DrivingCondition + geom_bar(col="black", size=.3) + scale_y_continuous(name = "Count",breaks=c(0:15))+scale_x_binned(n.breaks = 20) + scale_fill_discrete(name = "Condition", labels = c("Acrylic", "Bar", "Combination","Touch only")) + ggtitle("Drivers licence distribution")

SimulatorYesNoExperienceCondition <- ggplot(data=SartSusDemo, mapping=aes(x=Condition,fill = SimulatorExperience))
SimulatorYesNoExperienceCondition <- SimulatorYesNoExperienceCondition + geom_bar(col="black", size=.3) + scale_y_continuous(name = "Count",breaks=c(0:15)) + scale_x_discrete(labels=c("Acrylic","Bar","Combination","Touch only"))+scale_fill_discrete(name = "Car simulator experience") + ggtitle("Car simulator experience distribution")

CarGamesCondition <- ggplot(data=SartSusDemo, mapping=aes(x=Condition,fill = CarGames))
CarGamesCondition <- CarGamesCondition + geom_bar(col="black", size=.3) + scale_y_continuous(name = "Count",breaks=c(0:15)) + scale_x_discrete(labels=c("Acrylic","Bar","Combination","Touch only"))+scale_fill_discrete(name = "Car gaming (Hours)") + ggtitle("Car gaming experience distribution")

CarSimulatorExperienceCondition <- ggplot(data=SartSusDemo, mapping=aes(x=Condition,fill = CarSimulators))
CarSimulatorExperienceCondition <- CarSimulatorExperienceCondition + geom_bar(col="black", size=.3) + scale_y_continuous(name = "Count",breaks=c(0:15)) + scale_x_discrete(labels=c("Acrylic","Bar","Combination","Touch only"))+scale_fill_discrete(name = "Car simulator gaming (Hours)") + ggtitle("Car simulator gaming")

AutomaticExperienceCondition <- ggplot(data=SartSusDemo, mapping=aes(x=Condition,fill = Automatic))
AutomaticExperienceCondition <-AutomaticExperienceCondition + geom_bar(col="black", size=.3) + scale_y_continuous(name = "Count",breaks=c(0:15)) + scale_x_discrete(labels=c("Acrylic","Bar","Combination","Touch only"))+scale_fill_discrete(name = "Automatic experience  (Y/N)") + ggtitle("Automatic experience distribution")

GenderCondition
AgeCondition
ComputerCondition
DrivingCondition
SimulatorYesNoExperienceCondition
CarGamesCondition
AutomaticExperienceCondition
CarSimulatorExperienceCondition
```


## PLOT OF MEANS
```{r,echo=FALSE} 
## Gives count, mean, standard deviation, standard error of the mean, and confidence interval (default 95%).
##   data: a data frame.
##   measurevar: the name of a column that contains the variable to be summariezed
##   groupvars: a vector containing names of columns that contain grouping variables
##   na.rm: a boolean that indicates whether to ignore NA's
##   conf.interval: the percent range of the confidence interval (default is 95%)
summarySE <- function(data=NULL, measurevar, groupvars=NULL, na.rm=FALSE,
                      conf.interval=.95, .drop=TRUE) {
    library(plyr)

    # New version of length which can handle NA's: if na.rm==T, don't count them
    length2 <- function (x, na.rm=FALSE) {
        if (na.rm) sum(!is.na(x))
        else       length(x)
    }

    # This does the summary. For each group's data frame, return a vector with
    # N, mean, and sd
    datac <- ddply(data, groupvars, .drop=.drop,
      .fun = function(xx, col) {
        c(N    = length2(xx[[col]], na.rm=na.rm),
          mean = mean   (xx[[col]], na.rm=na.rm),
          sd   = sd     (xx[[col]], na.rm=na.rm)
        )
      },
      measurevar
    )

    # Rename the "mean" column    
    datac <- rename(datac, c("mean" = measurevar))

    datac$se <- datac$sd / sqrt(datac$N)  # Calculate standard error of the mean

    # Confidence interval multiplier for standard error
    # Calculate t-statistic for confidence interval: 
    # e.g., if conf.interval is .95, use .975 (above/below), and use df=N-1
    ciMult <- qt(conf.interval/2 + .5, datac$N-1)
    datac$ci <- datac$se * ciMult

    return(datac)
}
pd <- position_dodge(0.1) # move them .05 to the left and right

```

## Shapiro - Wilk test


## q-q plots
```{r}
Cond1 <- subset(SartSusDemo, SartSusDemo$Condition=='combination')
Cond2 <- subset(SartSusDemo, SartSusDemo$Condition=='touch_only')
Cond3 <- subset(SartSusDemo, SartSusDemo$Condition=='bar')
Cond4 <- subset(SartSusDemo, SartSusDemo$Condition=='acrylic')

  shapiro.test(Cond1$SUS)
  shapiro.test(Cond2$SUS)
  shapiro.test(Cond3$SUS)
  shapiro.test(Cond4$SUS)
  
  shapiro.test(Cond1$SART)
  shapiro.test(Cond2$SART)
  shapiro.test(Cond3$SART)
  shapiro.test(Cond4$SART)
  
  shapiro.test(Cond1$Total_Glance_time)
  shapiro.test(Cond2$Total_Glance_time)
  shapiro.test(Cond3$Total_Glance_time)
  shapiro.test(Cond4$Total_Glance_time)
  
  shapiro.test(Cond1$Total_Glances)
  shapiro.test(Cond2$Total_Glances)
  shapiro.test(Cond3$Total_Glances)
  shapiro.test(Cond4$Total_Glances)
  
  shapiro.test(Cond1$Lane_Breaks)
  shapiro.test(Cond2$Lane_Breaks)
  shapiro.test(Cond3$Lane_Breaks)
  shapiro.test(Cond4$Lane_Breaks)
  
  shapiro.test(Cond1$Total_crash)
  shapiro.test(Cond2$Total_crash)
  shapiro.test(Cond3$Total_crash)
  shapiro.test(Cond4$Total_crash)
```

The significantly not normally distributed metrics will be plottet with a qq plot to determnine how they are skewed
```{r}
library("car")
qqPlot(Cond1$SUS) 
# qqPlot(Cond2$SUS)
# qqPlot(Cond3$SUS)
# qqPlot(Cond4$SUS)

# qqPlot(Cond1$SART)
qqPlot(Cond2$SART)
# qqPlot(Cond3$SART)
# qqPlot(Cond4$SART)
# 
# qqPlot(Cond1$Total_Glance_time)
# qqPlot(Cond2$Total_Glance_time)
# qqPlot(Cond3$Total_Glance_time)
# qqPlot(Cond4$Total_Glance_time)
# 
# qqPlot(Cond1$Total_Glances)
qqPlot(Cond2$Total_Glances)
# qqPlot(Cond3$Total_Glances)
# qqPlot(Cond4$Total_Glances)
# 
# qqPlot(Cond1$Lane_Breaks)
# qqPlot(Cond2$Lane_Breaks)
qqPlot(Cond3$Lane_Breaks)
# qqPlot(Cond4$Lane_Breaks)

qqPlot(Cond1$Total_crash)
qqPlot(Cond2$Total_crash)
qqPlot(Cond3$Total_crash)
qqPlot(Cond4$Total_crash)
```

```{r}
library("car")
qqPlot(SartSusDemo$SUS)
qqPlot(SartSusDemo$SART)
qqPlot(SartSusDemo$Total_Glance_time)
qqPlot(SartSusDemo$Total_Glances)
qqPlot(SartSusDemo$Total_crash)
qqPlot(SartSusDemo$Lane_Breaks)
```



##Plot of means - All Dependent variables vs All Independent variables
Dependent variables: SUS - SART - Total Crash - Lane Breaks - Total Glances - Total Glance Time
Independent variables: Condition - Gender - Gaming - Drivers licence - Automatic gear - Car Simulator

```{r}
library(cowplot)
dev.new(width=5,height=4,noRStudioGD = TRUE)

SaveSixPlots <- function(Metric="NULL",filetype=".pdf"){
    dir.create(Metric)
    title1 <-paste(Metric, "-1-Condition",filetype, sep = "", collapse=NULL)
    title2 <-paste(Metric, "-2-Gender",filetype, sep = "", collapse=NULL)
    title3 <-paste(Metric, "-3-ComputerGames",filetype, sep = "", collapse=NULL)
    title4 <-paste(Metric, "-4-YearsDriversLicence",filetype, sep = "", collapse=NULL)
    title5 <-paste(Metric, "-5-SimulatorExperience",filetype, sep = "", collapse=NULL)
    title6 <-paste(Metric, "-6-Automatic",filetype, sep = "", collapse=NULL)
  
    ggsave(filename=title1,plot=plot1, path = Metric)
    ggsave(filename=title2,plot=plot2, path = Metric)
    ggsave(filename=title3,plot=plot3, path = Metric)
    ggsave(filename=title4,plot=plot4, path = Metric)
    ggsave(filename=title5,plot=plot5, path = Metric)
    ggsave(filename=title6,plot=plot6, path = Metric)
    
    plot1
    plot2
    plot3
    plot4
    plot5
    plot6
}

```

###Sammenhæng SART og SUS
```{r,echo=FALSE}
SARTSUS <- lm(SUS ~ SART, data = SartSusDemo)
summary(SARTSUS)
ggplot(SartSusDemo,aes(SART, SUS)) +
  geom_point() +
  geom_smooth(method='lm')
```


###SUS
```{r,echo=FALSE}
tgc <- summarySE(SartSusDemo, measurevar="SUS", groupvars=c("Condition"))
tgc
```
```{r,echo=FALSE}
# Use 95% confidence interval instead of SEM
plot1 <- ggplot(tgc, aes(x=Condition, y=SUS, colour=Condition)) + 
    geom_errorbar(aes(ymin=SUS-ci, ymax=SUS+ci), width=.1, position=pd) +
    geom_line(position=pd) +
    geom_point(position=pd)
```

```{r,echo=FALSE}
tgc <- summarySE(SartSusDemo, measurevar="SUS", groupvars=c("Gender"))
tgc
```
```{r ,echo=FALSE}
# Use 95% confidence interval instead of SEM
plot2 <- ggplot(tgc, aes(x=Gender, y=SUS, colour=Gender)) + 
    geom_errorbar(aes(ymin=SUS-ci, ymax=SUS+ci), width=.1, position=pd) +
    geom_line(position=pd) +
    geom_point(position=pd)


```

```{r,echo=FALSE}
tgc <- summarySE(SartSusDemo, measurevar="SUS", groupvars=c("ComputerGames"))
tgc
```
```{r,echo=FALSE}
# Use 95% confidence interval instead of SEM
plot3 <-ggplot(tgc, aes(x=ComputerGames, y=SUS, colour=ComputerGames)) + 
    geom_errorbar(aes(ymin=SUS-ci, ymax=SUS+ci), width=.1, position=pd) +
    geom_line(position=pd) +
    geom_point(position=pd)
```

```{r,echo=FALSE}
tgc <- summarySE(SartSusDemo, measurevar="SUS", groupvars=c("YearDriversLicence"))
tgc
```
```{r,echo=FALSE}
#Use 95% confidence interval instead of SEM
plot4 <- ggplot(tgc, aes(x=YearDriversLicence, y=SUS, colour=YearDriversLicence)) + 
     geom_errorbar(aes(ymin=SUS-ci, ymax=SUS+ci), width=.1, position=pd) +
     geom_line(position=pd) +
      geom_point(position=pd)
```

```{r,echo=FALSE}
tgc <- summarySE(SartSusDemo, measurevar="SUS", groupvars=c("SimulatorExperience"))
tgc
```
```{r,echo=FALSE}
# Use 95% confidence interval instead of SEM
plot5 <-ggplot(tgc, aes(x=SimulatorExperience, y=SUS, colour=SimulatorExperience)) + 
    geom_errorbar(aes(ymin=SUS-ci, ymax=SUS+ci), width=.1, position=pd) +
    geom_line(position=pd) +
    geom_point(position=pd)
```

```{r,echo=FALSE}
tgc <- summarySE(SartSusDemo, measurevar="SUS", groupvars=c("Automatic"))
tgc
```
```{r,echo=FALSE}
# Use 95% confidence interval instead of SEM
plot6 <-ggplot(tgc, aes(x=Automatic, y=SUS, colour=Automatic)) + 
    geom_errorbar(aes(ymin=SUS-ci, ymax=SUS+ci), width=.1, position=pd) +
    geom_line(position=pd) +
    geom_point(position=pd)
```

```{r}
  SaveSixPlots("SUS")
```


###Sart
```{r,echo=FALSE}
tgc <- summarySE(SartSusDemo, measurevar="SART", groupvars=c("Condition"))
tgc
```
```{r}
# Use 95% confidence interval instead of SEM
plot1 <- ggplot(tgc, aes(x=Condition, y=SART, colour=Condition)) + 
    geom_errorbar(aes(ymin=SART-ci, ymax=SART+ci), width=.1, position=pd) +
    geom_line(position=pd) +
    geom_point(position=pd)
```

```{r,echo=FALSE}
tgc <- summarySE(SartSusDemo, measurevar="SART", groupvars=c("Gender"))
tgc
```
```{r}
# Use 95% confidence interval instead of SEM
plot2 <- ggplot(tgc, aes(x=Gender, y=SART, colour=Gender)) + 
    geom_errorbar(aes(ymin=SART-ci, ymax=SART+ci), width=.1, position=pd) +
    geom_line(position=pd) +
    geom_point(position=pd)
```

```{r,echo=FALSE}
tgc <- summarySE(SartSusDemo, measurevar="SART", groupvars=c("ComputerGames"))
tgc
```
```{r}
# Use 95% confidence interval instead of SEM
plot3 <- ggplot(tgc, aes(x=ComputerGames, y=SART, colour=ComputerGames)) + 
    geom_errorbar(aes(ymin=SART-ci, ymax=SART+ci), width=.1, position=pd) +
    geom_line(position=pd) +
    geom_point(position=pd)
```

```{r,echo=FALSE}
  tgc <- summarySE(SartSusDemo, measurevar="SART", groupvars=c("YearDriversLicence"))
  tgc
```
```{r}
  #Use 95% confidence interval instead of SEM
  plot4 <- ggplot(tgc, aes(x=YearDriversLicence, y=SART, colour=YearDriversLicence)) + 
      geom_errorbar(aes(ymin=SART-ci, ymax=SART+ci), width=.1, position=pd) +
      geom_line(position=pd) +
      geom_point(position=pd)
```

```{r,echo=FALSE}
tgc <- summarySE(SartSusDemo, measurevar="SART", groupvars=c("SimulatorExperience"))
tgc
```
```{r}
# Use 95% confidence interval instead of SEM
plot5 <- ggplot(tgc, aes(x=SimulatorExperience, y=SART, colour=SimulatorExperience)) + 
    geom_errorbar(aes(ymin=SART-ci, ymax=SART+ci), width=.1, position=pd) +
    geom_line(position=pd) +
    geom_point(position=pd)
```

```{r,echo=FALSE}
tgc <- summarySE(SartSusDemo, measurevar="SART", groupvars=c("Automatic"))
tgc
```
```{r}
# Use 95% confidence interval instead of SEM
plot6 <- ggplot(tgc, aes(x=Automatic, y=SART, colour=Automatic)) + 
    geom_errorbar(aes(ymin=SART-ci, ymax=SART+ci), width=.1, position=pd) +
    geom_line(position=pd) +
    geom_point(position=pd)
```
```{r}
  SaveSixPlots("SART")
```
###Total crash
```{r,echo=FALSE}
tgc <- summarySE(SartSusDemo, measurevar="Total_crash", groupvars=c("Condition"))
tgc
```
```{r}
# Use 95% confidence interval instead of SEM
plot1 <- ggplot(tgc, aes(x=Condition, y=Total_crash, colour=Condition)) + 
    geom_errorbar(aes(ymin=Total_crash-ci, ymax=Total_crash+ci), width=.1, position=pd) +
    geom_line(position=pd) +
    geom_point(position=pd)
```

```{r,echo=FALSE}
tgc <- summarySE(SartSusDemo, measurevar="Total_crash", groupvars=c("Gender"))
tgc
```
```{r}
# Use 95% confidence interval instead of SEM
plot2 <- ggplot(tgc, aes(x=Gender, y=Total_crash, colour=Gender)) + 
    geom_errorbar(aes(ymin=Total_crash-ci, ymax=Total_crash+ci), width=.1, position=pd) +
    geom_line(position=pd) +
    geom_point(position=pd)
```

```{r,echo=FALSE}
tgc <- summarySE(SartSusDemo, measurevar="Total_crash", groupvars=c("ComputerGames"))
tgc
```
```{r}
# Use 95% confidence interval instead of SEM
plot3 <- ggplot(tgc, aes(x=ComputerGames, y=Total_crash, colour=ComputerGames)) + 
    geom_errorbar(aes(ymin=Total_crash-ci, ymax=Total_crash+ci), width=.1, position=pd) +
    geom_line(position=pd) +
    geom_point(position=pd)
```

```{r,echo=FALSE}
  tgc <- summarySE(SartSusDemo, measurevar="Total_crash", groupvars=c("YearDriversLicence"))
  tgc
```
```{r}
  #Use 95% confidence interval instead of SEM
  plot4 <- ggplot(tgc, aes(x=YearDriversLicence, y=Total_crash, colour=YearDriversLicence)) + 
      geom_errorbar(aes(ymin=Total_crash-ci, ymax=Total_crash+ci), width=.1, position=pd) +
      geom_line(position=pd) +
      geom_point(position=pd)
```

```{r,echo=FALSE}
tgc <- summarySE(SartSusDemo, measurevar="Total_crash", groupvars=c("SimulatorExperience"))
tgc
```
```{r}
# Use 95% confidence interval instead of SEM
plot5 <- ggplot(tgc, aes(x=SimulatorExperience, y=Total_crash, colour=SimulatorExperience)) + 
    geom_errorbar(aes(ymin=Total_crash-ci, ymax=Total_crash+ci), width=.1, position=pd) +
    geom_line(position=pd) +
    geom_point(position=pd)
```

```{r,echo=FALSE}
tgc <- summarySE(SartSusDemo, measurevar="Total_crash", groupvars=c("Automatic"))
tgc
```
```{r}
# Use 95% confidence interval instead of SEM
plot6 <- ggplot(tgc, aes(x=Automatic, y=Total_crash, colour=Automatic)) + 
    geom_errorbar(aes(ymin=Total_crash-ci, ymax=Total_crash+ci), width=.1, position=pd) +
    geom_line(position=pd) +
    geom_point(position=pd)
```
```{r}
  SaveSixPlots("Total_crash")
```

###Lane Breaks
```{r,echo=FALSE}
tgc <- summarySE(SartSusDemo, measurevar="Lane_Breaks", groupvars=c("Condition"))
tgc
```
```{r}
# Use 95% confidence interval instead of SEM
plot1 <- ggplot(tgc, aes(x=Condition, y=Lane_Breaks, colour=Condition)) + 
    geom_errorbar(aes(ymin=Lane_Breaks-ci, ymax=Lane_Breaks+ci), width=.1, position=pd) +
    geom_line(position=pd) +
    geom_point(position=pd)
```

```{r,echo=FALSE}
tgc <- summarySE(SartSusDemo, measurevar="Lane_Breaks", groupvars=c("Gender"))
tgc
```
```{r}
# Use 95% confidence interval instead of SEM
plot2 <- ggplot(tgc, aes(x=Gender, y=Lane_Breaks, colour=Gender)) + 
    geom_errorbar(aes(ymin=Lane_Breaks-ci, ymax=Lane_Breaks+ci), width=.1, position=pd) +
    geom_line(position=pd) +
    geom_point(position=pd)
```

```{r,echo=FALSE}
tgc <- summarySE(SartSusDemo, measurevar="Lane_Breaks", groupvars=c("ComputerGames"))
tgc
```
```{r}
# Use 95% confidence interval instead of SEM
plot3 <- ggplot(tgc, aes(x=ComputerGames, y=Lane_Breaks, colour=ComputerGames)) + 
    geom_errorbar(aes(ymin=Lane_Breaks-ci, ymax=Lane_Breaks+ci), width=.1, position=pd) +
    geom_line(position=pd) +
    geom_point(position=pd)
```

```{r,echo=FALSE}
  tgc <- summarySE(SartSusDemo, measurevar="Lane_Breaks", groupvars=c("YearDriversLicence"))
  tgc
```
```{r}
  #Use 95% confidence interval instead of SEM
  plot4 <- ggplot(tgc, aes(x=YearDriversLicence, y=Lane_Breaks, colour=YearDriversLicence)) + 
      geom_errorbar(aes(ymin=Lane_Breaks-ci, ymax=Lane_Breaks+ci), width=.1, position=pd) +
      geom_line(position=pd) +
      geom_point(position=pd)
```

```{r,echo=FALSE}
tgc <- summarySE(SartSusDemo, measurevar="Lane_Breaks", groupvars=c("SimulatorExperience"))
tgc
```
```{r}
# Use 95% confidence interval instead of SEM
plot5<- ggplot(tgc, aes(x=SimulatorExperience, y=Lane_Breaks, colour=SimulatorExperience)) + 
    geom_errorbar(aes(ymin=Lane_Breaks-ci, ymax=Lane_Breaks+ci), width=.1, position=pd) +
    geom_line(position=pd) +
    geom_point(position=pd)
```

```{r,echo=FALSE}
tgc <- summarySE(SartSusDemo, measurevar="Lane_Breaks", groupvars=c("Automatic"))
tgc
```
```{r}
# Use 95% confidence interval instead of SEM
plot6<- ggplot(tgc, aes(x=Automatic, y=Lane_Breaks, colour=Automatic)) + 
    geom_errorbar(aes(ymin=Lane_Breaks-ci, ymax=Lane_Breaks+ci), width=.1, position=pd) +
    geom_line(position=pd) +
    geom_point(position=pd)
```
```{r}
  SaveSixPlots("Lane_Breaks")
```

###Total Glances
```{r,echo=FALSE}
tgc <- summarySE(SartSusDemo, measurevar="Total_Glances", groupvars=c("Condition"))
tgc
```
```{r}
# Use 95% confidence interval instead of SEM
plot1<- ggplot(tgc, aes(x=Condition, y=Total_Glances, colour=Condition)) + 
    geom_errorbar(aes(ymin=Total_Glances-ci, ymax=Total_Glances+ci), width=.1, position=pd) +
    geom_line(position=pd) +
    geom_point(position=pd)
```

```{r,echo=FALSE}
tgc <- summarySE(SartSusDemo, measurevar="Total_Glances", groupvars=c("Gender"))
tgc
```
```{r}
# Use 95% confidence interval instead of SEM
plot2<- ggplot(tgc, aes(x=Gender, y=Total_Glances, colour=Gender)) + 
    geom_errorbar(aes(ymin=Total_Glances-ci, ymax=Total_Glances+ci), width=.1, position=pd) +
    geom_line(position=pd) +
    geom_point(position=pd)
```

```{r,echo=FALSE}
tgc <- summarySE(SartSusDemo, measurevar="Total_Glances", groupvars=c("ComputerGames"))
tgc
```
```{r}
# Use 95% confidence interval instead of SEM
plot3<- ggplot(tgc, aes(x=ComputerGames, y=Total_Glances, colour=ComputerGames)) + 
    geom_errorbar(aes(ymin=Total_Glances-ci, ymax=Total_Glances+ci), width=.1, position=pd) +
    geom_line(position=pd) +
    geom_point(position=pd)
```

```{r,echo=FALSE}
  tgc <- summarySE(SartSusDemo, measurevar="Total_Glances", groupvars=c("YearDriversLicence"))
  tgc
```
```{r}
  #Use 95% confidence interval instead of SEM
  plot4<- ggplot(tgc, aes(x=YearDriversLicence, y=Total_Glances, colour=YearDriversLicence)) + 
      geom_errorbar(aes(ymin=Total_Glances-ci, ymax=Total_Glances+ci), width=.1, position=pd) +
      geom_line(position=pd) +
      geom_point(position=pd)
```

```{r,echo=FALSE}
tgc <- summarySE(SartSusDemo, measurevar="Total_Glances", groupvars=c("SimulatorExperience"))
tgc
```
```{r}
# Use 95% confidence interval instead of SEM
plot5<- ggplot(tgc, aes(x=SimulatorExperience, y=Total_Glances, colour=SimulatorExperience)) + 
    geom_errorbar(aes(ymin=Total_Glances-ci, ymax=Total_Glances+ci), width=.1, position=pd) +
    geom_line(position=pd) +
    geom_point(position=pd)
```

```{r,echo=FALSE}
tgc <- summarySE(SartSusDemo, measurevar="Total_Glances", groupvars=c("Automatic"))
tgc
```
```{r}
# Use 95% confidence interval instead of SEM
plot6<- ggplot(tgc, aes(x=Automatic, y=Total_Glances, colour=Automatic)) + 
    geom_errorbar(aes(ymin=Total_Glances-ci, ymax=Total_Glances+ci), width=.1, position=pd) +
    geom_line(position=pd) +
    geom_point(position=pd)
```

```{r}
  SaveSixPlots("Total_Glances")
```
###Total Glance time 
```{r,echo=FALSE}
tgc <- summarySE(SartSusDemo, measurevar="Total_Glance_time", groupvars=c("Condition"))
tgc
```
```{r}
# Use 95% confidence interval instead of SEM
plot1<- ggplot(tgc, aes(x=Condition, y=Total_Glance_time, colour=Condition)) + 
    geom_errorbar(aes(ymin=Total_Glance_time-ci, ymax=Total_Glance_time+ci), width=.1, position=pd) +
    geom_line(position=pd) +
    geom_point(position=pd)
```

```{r,echo=FALSE}
tgc <- summarySE(SartSusDemo, measurevar="Total_Glance_time", groupvars=c("Gender"))
tgc
```
```{r}
# Use 95% confidence interval instead of SEM
plot2<- ggplot(tgc, aes(x=Gender, y=Total_Glance_time, colour=Gender)) + 
    geom_errorbar(aes(ymin=Total_Glance_time-ci, ymax=Total_Glance_time+ci), width=.1, position=pd) +
    geom_line(position=pd) +
    geom_point(position=pd)
```

```{r,echo=FALSE}
tgc <- summarySE(SartSusDemo, measurevar="Total_Glance_time", groupvars=c("ComputerGames"))
tgc
```
```{r}
# Use 95% confidence interval instead of SEM
plot3<- ggplot(tgc, aes(x=ComputerGames, y=Total_Glance_time, colour=ComputerGames)) + 
    geom_errorbar(aes(ymin=Total_Glance_time-ci, ymax=Total_Glance_time+ci), width=.1, position=pd) +
    geom_line(position=pd) +
    geom_point(position=pd)
```

```{r,echo=FALSE}
  tgc <- summarySE(SartSusDemo, measurevar="Total_Glance_time", groupvars=c("YearDriversLicence"))
  tgc
```
```{r}
# Use 95% confidence interval instead of SEM
  plot4<- ggplot(tgc, aes(x=YearDriversLicence, y=Total_Glance_time, colour=YearDriversLicence)) + 
      geom_errorbar(aes(ymin=Total_Glance_time-ci, ymax=Total_Glance_time+ci), width=.1, position=pd) +
      geom_line(position=pd) +
      geom_point(position=pd)
```

```{r,echo=FALSE}
tgc <- summarySE(SartSusDemo, measurevar="Total_Glance_time", groupvars=c("SimulatorExperience"))
tgc
```
```{r}
# Use 95% confidence interval instead of SEM
plot5<- ggplot(tgc, aes(x=SimulatorExperience, y=Total_Glance_time, colour=SimulatorExperience)) + 
    geom_errorbar(aes(ymin=Total_Glance_time-ci, ymax=Total_Glance_time+ci), width=.1, position=pd) +
    geom_line(position=pd) +
    geom_point(position=pd)
```

```{r,echo=FALSE}
tgc <- summarySE(SartSusDemo, measurevar="Total_Glance_time", groupvars=c("Automatic"))
tgc
```
```{r}
# Use 95% confidence interval instead of SEM
plot6<- ggplot(tgc, aes(x=Automatic, y=Total_Glance_time, colour=Automatic)) + 
    geom_errorbar(aes(ymin=Total_Glance_time-ci, ymax=Total_Glance_time+ci), width=.1, position=pd) +
    geom_line(position=pd) +
    geom_point(position=pd)
```

```{r}
  SaveSixPlots("Total_Glance_Time")
```


## Boxplots

```{r}
library(ggplot2)
SusCondition=ggplot(data=SartSusDemo, mapping=aes(x=Condition, y=SUS,fill = Condition))+geom_boxplot()
SartCondition=ggplot(data=SartSusDemo, mapping=aes(x=Condition, y=SART,fill = Condition))+geom_boxplot()
SusGender=ggplot(data=SartSusDemo, mapping=aes(x=Gender, y=SUS,fill = Gender))+geom_boxplot()
SartGender=ggplot(data=SartSusDemo, mapping=aes(x=Gender, y=SART,fill = Gender))+geom_boxplot()
SusComputerGames=ggplot(data=SartSusDemo, mapping=aes(x=ComputerGames, y=SUS,fill = ComputerGames))+geom_boxplot()
SartComputerGames=ggplot(data=SartSusDemo, mapping=aes(x=ComputerGames, y=SART,fill = ComputerGames))+geom_boxplot()

SusCondition
SartCondition
SusGender
SartGender
SusComputerGames
SartComputerGames
```

##T-tests
```{r}
Combi <- SartSusDemo[which(SartSusDemo$Condition=='combination'),]
Touch <- SartSusDemo[which(SartSusDemo$Condition=='touch_only'),]
Bar <- SartSusDemo[which(SartSusDemo$Condition=='bar'),]
Acrylic <- SartSusDemo[which(SartSusDemo$Condition=='acrylic'),]

CombiTouch <- subset(SartSusDemo, Condition=='combination' | Condition=='touch_only', 
select=c(Participants, SUS,Condition))


TSusCondition = t.test(formula = SUS ~ Condition, data = CombiTouch)
TSusCondition

one.way <- aov(SUS ~ Condition, data = SartSusDemo)
summary(one.way)

```

```{r}
TSusGender = t.test(formula = SUS ~ Gender, data = SartSusDemo)
TSartGender = t.test(formula = SART ~ Gender, data = SartSusDemo)

TSusGender
TSartGender

```

# Hypoteser

1.  Der er forskel mellem aid og no aid
2.  Én aid er bedre end de andre
3.  Hvor meget man spiller computerspil har en indflydelse på hvor godt
    man kører
4.  Lange glances leder til flere crashes eller swerves
5.  Køreevne er forskellige mellem mænd og kvinder

# Datavisualisering

**Plot of means** eller **Boxplot** Overblik over alle forskellige
produkt metrics og aid konditioner

For hver aid kondition: \* `Total glance time` \* `Glances per task` \*
`Total glances` \* `Total lane breaks` \* `Total crashes` \* `SUS` \*
`SART`

Aid kondition på x-akse, metric på y-akse

Hvis vi laver alle plots i samme rækkefølge kan vi lave et stort grid af
plots for nem sammenligning på tværs af metrics og konditioner.

# Test

Hvilke test skal vi lave på hvilke metrics for hver af de mulige
hypoteser

### Én aid er bedre end no aid og de andre aids

**Variabler** Independent variable: \* kondition Dependent variables:
(Kan ville lægge alle dem her sammen på en måde? Altså en samlet
kørescore) \* `Total glance time` \* `Glances per task` \*
`Total glances` \* `Total lane breaks` \* `Total crashes`

**Signifikans test** \* ANOVA på alle køre metrics for hver kondition
(Det bliver mange tal) \* ANOVA på SUS score for hver kondition \* ANOVA
på SART score for hver kondition

**Alpha inflation korrektion** Benjamini--Hochberg adjustment (Benjamini
and Hochberg, 1995) (Sauro & Lewis, 2016 p. 266). Det er en mindre
konservativ korrektion end Bon Ferroni så der er større change for at
finde en effekt men vi korrigere stadig for gentagne test (alpha
inflation).

### Lange glances leder til crash eller swerve

Independent variable: \* `GT>1.5` \* `TGT>12`

Dependent variables:

### Hvor meget man spiller computerspil har en indflydelse på hvor godt man kører

Independent variable: \* Over / under 5 timer gaming om ugen (`5+` /
`5-`)

Dependent variables: \* Total crashes \* Total lane breaks

ANOVA på om `5-` er anderledes end `5+` og om der er interaktion mellem
`Crash` og `lane break`

\# Requirements \### 12 sek glance per opgave Mean total glance time for
hver opgave. Vi skal sortere i de opgaver der ikke kan bruges til noget
her. Det vil måske være lidt useless fordi de dybere opgaver ikke er
færdige nok til at teste på.

```{r pressure, echo=FALSE}
plot(pressure)

```

Note that the `echo = FALSE` parameter was added to the code chunk to
prevent printing of the R code that generated the plot.
